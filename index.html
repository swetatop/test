<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тестування GTA 5</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== ГЛОБАЛЬНІ СТИЛІ ===== */
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-dashboard: #0f0f0f;
            --bg-card: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --accent-red: #ff0000;
            --accent-blue: #0057b7;
            --accent-green: #00ff00;
            --accent-yellow: #ffd700;
            --accent-purple: #800080;
            --border-color: #333333;
            --border-light: #444444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 0, 0, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(0, 87, 183, 0.05) 0%, transparent 20%);
        }

        .container {
            max-width: 900px;
            width: 100%;
            text-align: center;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== ШАПКА ===== */
        .header {
            margin-bottom: 40px;
        }

        .site-title {
            font-family: 'Roboto Condensed', sans-serif;
            font-size: 2.5rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 3px;
            background: linear-gradient(90deg, #fff, var(--accent-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .title-line {
            height: 4px;
            background: linear-gradient(90deg, var(--accent-red), var(--accent-blue));
            width: 300px;
            margin: 15px auto;
            border-radius: 2px;
        }

        .site-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            letter-spacing: 2px;
            margin-top: 10px;
        }

        /* ===== КНОПКИ ===== */
        .buttons-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 30px 0;
        }

        .main-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            padding: 25px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1.8rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .main-button:hover {
            transform: translateY(-5px);
        }

        .login-btn {
            border-color: var(--accent-green);
            background: linear-gradient(135deg, rgba(0, 255, 0, 0.1), rgba(0, 255, 0, 0.05));
            box-shadow: 0 5px 15px rgba(0, 255, 0, 0.2);
        }

        .login-btn:hover {
            border-color: #00ff00;
            box-shadow: 0 10px 25px rgba(0, 255, 0, 0.3);
        }

        .register-btn {
            border-color: var(--accent-blue);
            background: linear-gradient(135deg, rgba(0, 87, 183, 0.1), rgba(0, 87, 183, 0.05));
            box-shadow: 0 5px 15px rgba(0, 87, 183, 0.2);
        }

        .register-btn:hover {
            border-color: #007bff;
            box-shadow: 0 10px 25px rgba(0, 87, 183, 0.3);
        }

        .button-icon {
            font-size: 2rem;
            transition: transform 0.3s ease;
        }

        .login-btn:hover .button-icon {
            transform: translateX(5px);
        }

        .register-btn:hover .button-icon {
            transform: rotate(90deg);
        }

        /* ===== ФОРМИ ===== */
        .form-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
        }

        .form-header {
            margin-bottom: 25px;
        }

        .form-header h2 {
            font-family: 'Roboto Condensed', sans-serif;
            font-size: 1.5rem;
            text-transform: uppercase;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .form-line {
            height: 2px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-red));
            width: 100px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-red);
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.2);
        }

        .form-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .login-form-btn {
            background: linear-gradient(135deg, #0057b7, #004494);
            color: white;
        }

        .login-form-btn:hover {
            background: linear-gradient(135deg, #0066cc, #0057b7);
            transform: translateY(-2px);
        }

        .register-form-btn {
            background: linear-gradient(135deg, #ff0000, #cc0000);
            color: white;
        }

        .register-form-btn:hover {
            background: linear-gradient(135deg, #ff3333, #ff0000);
            transform: translateY(-2px);
        }

        .back-btn {
            width: 100%;
            padding: 12px;
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .back-btn:hover {
            background: rgba(255, 0, 0, 0.1);
            border-color: var(--accent-red);
            color: var(--text-primary);
        }

        /* ===== ОСОБИСТИЙ КАБІНЕТ ===== */
        .dashboard-container {
            background: var(--bg-dashboard);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
        }

        .dashboard-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .dashboard-header h2 {
            font-family: 'Roboto Condensed', sans-serif;
            font-size: 1.8rem;
            text-transform: uppercase;
            margin-bottom: 10px;
            color: var(--accent-yellow);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .user-info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid var(--border-light);
        }

        .user-name {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .user-email {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .user-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .user-stats span {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
        }

        .user-stats strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .admin-panel-btn {
            margin: 20px auto;
            padding: 12px 25px;
            background: linear-gradient(135deg, #ff0000, #cc0000);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: none;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .admin-panel-btn:hover {
            background: linear-gradient(135deg, #ff3333, #ff0000);
            transform: translateY(-2px);
        }

        /* Секції */
        .section {
            margin-bottom: 30px;
        }

        .section h3 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
            color: var(--accent-blue);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Тести */
        .tests-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .test-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: left;
        }

        .test-card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-3px);
        }

        .test-card-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .test-card-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .test-card-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .test-card-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .test-card-btn {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, var(--accent-blue), #004494);
            border: none;
            border-radius: 6px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .test-card-btn:hover {
            background: linear-gradient(135deg, #0066cc, var(--accent-blue));
        }

        .loading-tests {
            grid-column: 1 / -1;
            text-align: center;
            padding: 50px 20px;
            color: var(--text-muted);
        }

        .loading-tests i {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        /* Таблиця результатів */
        .results-table {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            overflow: hidden;
        }

        .table-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            padding: 15px;
            background: rgba(0, 87, 183, 0.2);
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            border-bottom: 1px solid var(--border-color);
        }

        .table-body {
            min-height: 100px;
        }

        .result-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            padding: 15px;
            border-bottom: 1px solid var(--border-light);
            align-items: center;
        }

        .result-row:last-child {
            border-bottom: none;
        }

        .result-row:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .empty-row {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .empty-row i {
            font-size: 2rem;
            margin-bottom: 10px;
            opacity: 0.5;
        }

        .status-waiting {
            color: var(--accent-yellow);
            font-weight: 600;
        }

        .status-passed {
            color: var(--accent-green);
            font-weight: 600;
        }

        .status-failed {
            color: var(--accent-red);
            font-weight: 600;
        }

        /* Кнопка виходу */
        .logout-btn {
            width: 100%;
            padding: 15px;
            margin-top: 30px;
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid var(--accent-red);
            border-radius: 8px;
            color: var(--accent-red);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .logout-btn:hover {
            background: rgba(255, 0, 0, 0.2);
            transform: translateY(-2px);
        }

        /* ===== СТОРІНКА ТЕСТУ ===== */
        .test-container {
            background: var(--bg-dashboard);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
        }

        .test-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent-blue);
        }

        .test-title {
            font-family: 'Roboto Condensed', sans-serif;
            font-size: 1.8rem;
            text-transform: uppercase;
            margin-bottom: 10px;
            color: var(--accent-yellow);
        }

        .test-meta {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .test-meta span {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
        }

        .test-meta strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        /* Прогрес-бар */
        .progress-container {
            margin: 30px 0;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-green));
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Блок питання */
        .question-block {
            margin: 30px 0;
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .question-number {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .question-text {
            font-size: 1.3rem;
            line-height: 1.6;
            color: var(--text-primary);
        }

        /* Варіанти відповідей */
        .answers-block {
            margin: 30px 0;
        }

        .answer-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            margin-bottom: 10px;
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .answer-option:hover {
            border-color: var(--accent-blue);
            background: rgba(255, 255, 255, 0.1);
        }

        .answer-option.selected {
            border-color: var(--accent-blue);
            background: rgba(0, 87, 183, 0.2);
        }

        .option-marker {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            flex-shrink: 0;
        }

        .answer-option.selected .option-marker {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            color: white;
        }

        .answer-text {
            flex: 1;
            font-size: 1rem;
            text-align: left;
        }

        /* Текстова відповідь */
        .text-answer textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            resize: vertical;
            font-family: 'Inter', sans-serif;
        }

        .text-answer textarea:focus {
            outline: none;
            border-color: var(--accent-red);
        }

        /* Керування тестом */
        .test-controls {
            display: flex;
            gap: 15px;
            margin: 30px 0;
        }

        .btn-primary,
        .btn-secondary,
        .btn-success {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-blue), #004494);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #0066cc, var(--accent-blue));
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--accent-green), #00cc00);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #00ff00, var(--accent-green));
            transform: translateY(-2px);
        }

        .btn-primary:disabled,
        .btn-secondary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* ===== СТОРІНКА РЕЗУЛЬТАТІВ ===== */
        .results-container {
            background: var(--bg-dashboard);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent-green);
        }

        .results-header h2 {
            font-family: 'Roboto Condensed', sans-serif;
            font-size: 1.8rem;
            text-transform: uppercase;
            margin-bottom: 10px;
            color: var(--accent-yellow);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .result-card {
            text-align: center;
            padding: 40px;
            background: var(--bg-card);
            border-radius: 12px;
            margin: 30px 0;
            border: 2px solid var(--accent-green);
        }

        .result-icon {
            font-size: 3.5rem;
            color: var(--accent-green);
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .result-message {
            font-size: 1.1rem;
            color: var(--text-secondary);
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }

        .test-details {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 25px;
            margin: 30px 0;
            border: 1px solid var(--border-color);
        }

        .test-details h4 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border: 1px solid var(--border-light);
        }

        .detail-label {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .detail-value {
            color: var(--text-primary);
            font-weight: 600;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        /* ===== АДМІН-ПАНЕЛЬ ===== */
        .admin-container {
            background: var(--bg-dashboard);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
        }

        .admin-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .admin-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .admin-title h2 {
            font-family: 'Roboto Condensed', sans-serif;
            font-size: 2rem;
            text-transform: uppercase;
            color: var(--accent-yellow);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-3px);
        }

        .stat-icon {
            font-size: 2.5rem;
            color: var(--accent-blue);
            margin-bottom: 15px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* Таби адмінки */
        .admin-tabs {
            margin-top: 30px;
        }

        .tab-navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
            overflow-x: auto;
        }

        .tab-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, var(--accent-blue), #004494);
            color: white;
            border-color: var(--accent-blue);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* Вкладки */
        .tab-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-light);
        }

        .tab-header h3 {
            font-size: 1.4rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-box {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-box input {
            padding: 10px 15px 10px 40px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            min-width: 250px;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            color: var(--text-muted);
        }

        /* Списки в адмінці */
        .users-list,
        .tests-list,
        .results-admin-list {
            display: grid;
            gap: 15px;
        }

        .admin-item {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .admin-item:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }

        .item-info {
            flex: 1;
        }

        .item-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .item-details {
            font-size: 0.9rem;
            color: var(--text-secondary);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .item-details span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .item-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn-sm {
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-view {
            background: rgba(0, 255, 0, 0.2);
            color: var(--accent-green);
            border: 1px solid var(--accent-green);
        }

        .btn-view:hover {
            background: rgba(0, 255, 0, 0.3);
        }

        .btn-edit {
            background: rgba(0, 87, 183, 0.2);
            color: var(--accent-blue);
            border: 1px solid var(--accent-blue);
        }

        .btn-edit:hover {
            background: rgba(0, 87, 183, 0.3);
        }

        .btn-delete {
            background: rgba(255, 0, 0, 0.2);
            color: var(--accent-red);
            border: 1px solid var(--accent-red);
        }

        .btn-delete:hover {
            background: rgba(255, 0, 0, 0.3);
        }

        .btn-status {
            background: rgba(255, 215, 0, 0.2);
            color: var(--accent-yellow);
            border: 1px solid var(--accent-yellow);
        }

        .btn-status:hover {
            background: rgba(255, 215, 0, 0.3);
        }

        /* Синхронізація */
        .sync-status {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }

        .status-card {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-light);
        }

        .status-card:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .status-card h4 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }

        .status-dot.online {
            background: var(--accent-green);
            box-shadow: 0 0 10px var(--accent-green);
        }

        .status-dot.offline {
            background: var(--accent-red);
            box-shadow: 0 0 10px var(--accent-red);
        }

        .status-dot.syncing {
            background: var(--accent-yellow);
            box-shadow: 0 0 10px var(--accent-yellow);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .sync-actions {
            display: flex;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .sync-info {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--border-light);
        }

        .sync-info h4 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border: 1px solid var(--border-light);
        }

        .info-item span {
            color: var(--text-secondary);
        }

        .info-item strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        /* ===== МОДАЛЬНІ ВІКНА ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal {
            background: var(--bg-secondary);
            border-radius: 12px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 1.4rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.8rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            color: var(--accent-red);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Чекбокс */
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        /* ===== ФУТЕР ===== */
        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            text-align: center;
        }

        .footer-content {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .footer-note {
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        /* ===== АДАПТИВНІСТЬ ===== */
        @media (max-width: 768px) {
            .container {
                max-width: 95%;
                padding: 10px;
            }
            
            .site-title {
                font-size: 2rem;
            }
            
            .main-button {
                font-size: 1.5rem;
                padding: 20px;
            }
            
            .button-icon {
                font-size: 1.5rem;
            }
            
            .form-container {
                padding: 20px;
            }
            
            .dashboard-container,
            .test-container,
            .results-container,
            .admin-container {
                padding: 20px;
            }
            
            .test-meta {
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .test-controls,
            .action-buttons {
                flex-direction: column;
            }
            
            .tests-grid {
                grid-template-columns: 1fr;
            }
            
            .table-header,
            .result-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .admin-title {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .tab-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .search-box input {
                min-width: 100%;
            }
            
            .admin-stats {
                grid-template-columns: 1fr;
            }
            
            .admin-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .item-actions {
                width: 100%;
                justify-content: flex-end;
            }
            
            .sync-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .site-title {
                font-size: 1.7rem;
            }
            
            .main-button {
                font-size: 1.3rem;
                padding: 18px;
            }
            
            .site-subtitle {
                font-size: 1rem;
            }
            
            .test-title,
            .dashboard-header h2,
            .results-header h2,
            .admin-title h2 {
                font-size: 1.4rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ===== ГОЛОВНА СТОРІНКА ===== -->
        <div id="mainPage" class="page active">
            <header class="header">
                <div class="site-title">ТЕСТУВАННЯ GTA 5</div>
                <div class="title-line"></div>
                <div class="site-subtitle">Система тестування модерації</div>
            </header>
            
            <div class="buttons-container">
                <button class="main-button login-btn" id="loginBtn">
                    <span class="button-icon"><i class="fas fa-sign-in-alt"></i></span>
                    <span class="button-text">ВХІД</span>
                </button>
                
                <button class="main-button register-btn" id="registerBtn">
                    <span class="button-icon"><i class="fas fa-user-plus"></i></span>
                    <span class="button-text">РЕЄСТРАЦІЯ</span>
                </button>
            </div>
            
            <!-- Форма входу -->
            <div id="loginForm" class="form-container" style="display: none;">
                <div class="form-header">
                    <h2><i class="fas fa-key"></i> ВХІД ДО СИСТЕМИ</h2>
                    <div class="form-line"></div>
                </div>
                
                <form id="loginFormElement">
                    <div class="form-group">
                        <label for="email"><i class="fas fa-envelope"></i> Електронна пошта</label>
                        <input type="email" id="email" placeholder="ваш.email@example.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password"><i class="fas fa-lock"></i> Пароль</label>
                        <input type="password" id="password" placeholder="Введіть ваш пароль" required>
                    </div>
                    
                    <button type="submit" class="form-btn login-form-btn">
                        <i class="fas fa-sign-in-alt"></i> УВІЙТИ
                    </button>
                </form>
                
                <button class="back-btn" id="backFromLogin">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
            </div>
            
            <!-- Форма реєстрації -->
            <div id="registerForm" class="form-container" style="display: none;">
                <div class="form-header">
                    <h2><i class="fas fa-user-plus"></i> РЕЄСТРАЦІЯ</h2>
                    <div class="form-line"></div>
                </div>
                
                <form id="registerFormElement">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName"><i class="fas fa-user"></i> Ім'я</label>
                            <input type="text" id="firstName" placeholder="Іван" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="lastName"><i class="fas fa-user"></i> Прізвище</label>
                            <input type="text" id="lastName" placeholder="Коваль" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="regEmail"><i class="fas fa-envelope"></i> Електронна пошта</label>
                        <input type="email" id="regEmail" placeholder="ваш.email@example.com" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="regPassword"><i class="fas fa-lock"></i> Пароль</label>
                            <input type="password" id="regPassword" placeholder="Придумайте пароль" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmPassword"><i class="fas fa-lock"></i> Підтвердження пароля</label>
                            <input type="password" id="confirmPassword" placeholder="Повторіть пароль" required>
                        </div>
                    </div>
                    
                    <button type="submit" class="form-btn register-form-btn">
                        <i class="fas fa-check"></i> ЗАРЕЄСТРУВАТИСЯ
                    </button>
                </form>
                
                <button class="back-btn" id="backFromRegister">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
            </div>
        </div>
        
        <!-- ===== ОСОБИСТИЙ КАБІНЕТ ===== -->
        <div id="dashboard" class="page">
            <div class="dashboard-container">
                <div class="dashboard-header">
                    <h2><i class="fas fa-user-circle"></i> ОСОБИСТИЙ КАБІНЕТ</h2>
                    <div class="form-line"></div>
                    <div class="user-info">
                        <div class="user-name" id="userName">Іван Коваль</div>
                        <div class="user-email" id="userEmail">ivan@example.com</div>
                        <div class="user-stats">
                            <span><i class="fas fa-chart-line"></i> Тестів пройдено: <strong id="testsPassed">0</strong></span>
                            <span><i class="fas fa-calendar"></i> Останній: <strong id="lastTestDate">-</strong></span>
                        </div>
                    </div>
                    
                    <!-- Кнопка адмінки (тільки для адмінів) -->
                    <button class="admin-panel-btn" id="adminPanelBtn" style="display: none;">
                        <i class="fas fa-cogs"></i> АДМІН-ПАНЕЛЬ
                    </button>
                </div>
                
                <div class="dashboard-content">
                    <!-- Доступні тести -->
                    <div class="section">
                        <h3><i class="fas fa-list-alt"></i> ДОСТУПНІ ТЕСТИ</h3>
                        <div class="tests-grid" id="testsList">
                            <div class="loading-tests">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Завантаження тестів...</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Мої результати -->
                    <div class="section">
                        <h3><i class="fas fa-history"></i> ІСТОРІЯ ТЕСТУВАНЬ</h3>
                        <div class="results-table">
                            <div class="table-header">
                                <div class="header-cell">Тест</div>
                                <div class="header-cell">Дата</div>
                                <div class="header-cell">Час</div>
                                <div class="header-cell">Статус</div>
                            </div>
                            <div class="table-body" id="resultsList">
                                <div class="empty-row">
                                    <i class="fas fa-inbox"></i>
                                    <p>У вас ще немає результатів</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> ВИЙТИ З СИСТЕМИ
                </button>
            </div>
        </div>
        
        <!-- ===== СТОРІНКА ТЕСТУ ===== -->
        <div id="testPage" class="page">
            <div class="test-container">
                <div class="test-header">
                    <div class="test-title" id="testTitle">Назва тесту</div>
                    <div class="form-line"></div>
                    <div class="test-meta">
                        <span><i class="fas fa-clock"></i> Час: <strong id="timer">00:00</strong></span>
                        <span><i class="fas fa-question-circle"></i> Питання: <strong id="questionCounter">0/0</strong></span>
                    </div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-info">
                        <span>Прогрес тесту</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
                
                <div class="question-block">
                    <div class="question-number" id="questionNumber">ПИТАННЯ 1</div>
                    <div class="question-text" id="questionText">
                        Текст питання завантажується...
                    </div>
                </div>
                
                <div class="answers-block" id="answersContainer">
                    <!-- Відповіді завантажуються динамічно -->
                </div>
                
                <div class="test-controls">
                    <button class="btn-secondary" id="prevBtn" disabled>
                        <i class="fas fa-arrow-left"></i> Попереднє
                    </button>
                    <button class="btn-primary" id="nextBtn">
                        Наступне <i class="fas fa-arrow-right"></i>
                    </button>
                    <button class="btn-success" id="finishBtn" style="display: none;">
                        <i class="fas fa-flag-checkered"></i> Завершити тест
                    </button>
                </div>
                
                <button class="back-btn" id="backFromTest">
                    <i class="fas fa-arrow-left"></i> Повернутися в кабінет
                </button>
            </div>
        </div>
        
        <!-- ===== СТОРІНКА РЕЗУЛЬТАТІВ ===== -->
        <div id="resultsPage" class="page">
            <div class="results-container">
                <div class="results-header">
                    <h2><i class="fas fa-trophy"></i> ТЕСТ ЗАВЕРШЕНО</h2>
                    <div class="form-line"></div>
                </div>
                
                <div class="results-content">
                    <div class="result-card">
                        <div class="result-icon">
                            <i class="fas fa-paper-plane"></i>
                        </div>
                        <h3 class="result-title">Результат відправлено!</h3>
                        <p class="result-message">
                            Ваші відповіді успішно збережено та відправлено на перевірку адміністратору.
                            Результати будуть опубліковані протягом 24 годин.
                        </p>
                    </div>
                    
                    <div class="test-details">
                        <h4><i class="fas fa-info-circle"></i> Інформація про тест</h4>
                        <div class="details-grid">
                            <div class="detail-item">
                                <span class="detail-label">Тест:</span>
                                <span class="detail-value" id="detailTestName">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Дата:</span>
                                <span class="detail-value" id="detailDate">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Витрачений час:</span>
                                <span class="detail-value" id="detailTime">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Статус:</span>
                                <span class="detail-value status-waiting">ОЧІКУЄ ПЕРЕВІРКИ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn-primary" id="newTestBtn">
                            <i class="fas fa-redo"></i> Пройти новий тест
                        </button>
                        <button class="btn-secondary" id="toDashboardBtn">
                            <i class="fas fa-home"></i> Повернутися в кабінет
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ===== АДМІН-ПАНЕЛЬ ===== -->
        <div id="adminPage" class="page">
            <div class="admin-container">
                <div class="admin-header">
                    <div class="admin-title">
                        <h2><i class="fas fa-cogs"></i> АДМІН-ПАНЕЛЬ</h2>
                        <button class="btn-secondary" id="backFromAdmin">
                            <i class="fas fa-arrow-left"></i> До кабінету
                        </button>
                    </div>
                    <div class="form-line"></div>
                    
                    <div class="admin-stats">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number" id="adminUsersCount">0</div>
                                <div class="stat-label">Користувачів</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-list-alt"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number" id="adminTestsCount">0</div>
                                <div class="stat-label">Тестів</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number" id="adminResultsCount">0</div>
                                <div class="stat-label">Результатів</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Таби адмін-панелі -->
                <div class="admin-tabs">
                    <div class="tab-navigation">
                        <button class="tab-btn active" data-tab="users">
                            <i class="fas fa-users"></i> Користувачі
                        </button>
                        <button class="tab-btn" data-tab="tests">
                            <i class="fas fa-list-alt"></i> Тести
                        </button>
                        <button class="tab-btn" data-tab="results">
                            <i class="fas fa-chart-bar"></i> Результати
                        </button>
                        <button class="tab-btn" data-tab="sync">
                            <i class="fas fa-sync-alt"></i> Синхронізація
                        </button>
                    </div>
                    
                    <!-- Вкладка Користувачі -->
                    <div class="tab-content active" id="tab-users">
                        <div class="tab-header">
                            <h3><i class="fas fa-users"></i> Усі користувачі</h3>
                            <div class="search-box">
                                <input type="text" id="userSearch" placeholder="Пошук користувача..." onkeyup="filterUsers()">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <div class="users-list" id="usersList">
                            <!-- Користувачі завантажуються через JS -->
                        </div>
                    </div>
                    
                    <!-- Вкладка Тести -->
                    <div class="tab-content" id="tab-tests">
                        <div class="tab-header">
                            <h3><i class="fas fa-list-alt"></i> Керування тестами</h3>
                            <button class="btn-primary" id="addTestBtn">
                                <i class="fas fa-plus"></i> Додати тест
                            </button>
                        </div>
                        <div class="tests-list" id="testsAdminList">
                            <!-- Тести завантажуються через JS -->
                        </div>
                    </div>
                    
                    <!-- Вкладка Результати -->
                    <div class="tab-content" id="tab-results">
                        <div class="tab-header">
                            <h3><i class="fas fa-chart-bar"></i> Усі результати</h3>
                            <div class="search-box">
                                <input type="text" id="resultSearch" placeholder="Пошук результатів..." onkeyup="filterResults()">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <div class="results-admin-list" id="resultsAdminList">
                            <!-- Результати завантажуються через JS -->
                        </div>
                    </div>
                    
                    <!-- Вкладка Синхронізація -->
                    <div class="tab-content" id="tab-sync">
                        <div class="tab-header">
                            <h3><i class="fas fa-sync-alt"></i> Синхронізація з Firebase</h3>
                        </div>
                        <div class="sync-status">
                            <div class="status-card">
                                <h4><i class="fas fa-database"></i> Статус бази даних</h4>
                                <div class="status-indicator" id="firebaseStatus">
                                    <span class="status-dot offline"></span>
                                    <span>Не підключено</span>
                                </div>
                                <p class="status-text" id="firebaseStatusText">
                                    Очікування підключення до Firebase...
                                </p>
                            </div>
                            
                            <div class="sync-actions">
                                <button class="btn-primary" onclick="forceSync()">
                                    <i class="fas fa-sync"></i> Примусова синхронізація
                                </button>
                                <button class="btn-secondary" onclick="exportToJSON()">
                                    <i class="fas fa-download"></i> Експорт у JSON
                                </button>
                                <button class="btn-secondary" onclick="importFromJSON()">
                                    <i class="fas fa-upload"></i> Імпорт з JSON
                                </button>
                            </div>
                            
                            <div class="sync-info">
                                <h4><i class="fas fa-info-circle"></i> Інформація про синхронізацію</h4>
                                <div class="info-grid">
                                    <div class="info-item">
                                        <span>Остання синхронізація:</span>
                                        <strong id="lastSyncTime">Ніколи</strong>
                                    </div>
                                    <div class="info-item">
                                        <span>Користувачів онлайн:</span>
                                        <strong id="onlineUsers">0</strong>
                                    </div>
                                    <div class="info-item">
                                        <span>Активних тестів:</span>
                                        <strong id="activeTests">0</strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Модальні вікна -->
        <div class="modal-overlay" id="modalOverlay" style="display: none;">
            <div class="modal" id="testModal">
                <div class="modal-header">
                    <h3><i class="fas fa-list-alt"></i> <span id="modalTitle">Новий тест</span></h3>
                    <button class="modal-close" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="testForm">
                        <input type="hidden" id="testId">
                        <div class="form-group">
                            <label for="testName">Назва тесту *</label>
                            <input type="text" id="testName" placeholder="Введіть назву тесту" required>
                        </div>
                        <div class="form-group">
                            <label for="testDescription">Опис тесту</label>
                            <textarea id="testDescription" rows="2" placeholder="Короткий опис тесту"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="testTime">Час (хвилини) *</label>
                                <input type="number" id="testTime" min="1" max="180" value="30" required>
                            </div>
                            <div class="form-group">
                                <label for="testQuestions">Кількість питань *</label>
                                <input type="number" id="testQuestions" min="1" value="10" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="testActive" checked>
                                <span>Активний тест</span>
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary modal-close" onclick="closeModal()">Скасувати</button>
                    <button class="btn-primary" id="saveTestBtn">Зберегти тест</button>
                </div>
            </div>
            
            <div class="modal" id="statusModal">
                <div class="modal-header">
                    <h3><i class="fas fa-edit"></i> Змінити статус результату</h3>
                    <button class="modal-close" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="status-info" id="statusInfo"></div>
                    <div class="form-group">
                        <label for="statusSelect">Новий статус</label>
                        <select id="statusSelect">
                            <option value="waiting">🟡 Очікує перевірки</option>
                            <option value="passed">🟢 Пройшов успішно</option>
                            <option value="failed">🔴 Не пройшов</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary modal-close" onclick="closeModal()">Скасувати</button>
                    <button class="btn-primary" id="saveStatusBtn">Зберегти статус</button>
                </div>
            </div>
            
            <div class="modal" id="questionModal">
                <div class="modal-header">
                    <h3><i class="fas fa-question-circle"></i> Додати питання</h3>
                    <button class="modal-close" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="questionForm">
                        <input type="hidden" id="questionId">
                        <input type="hidden" id="questionTestId">
                        <div class="form-group">
                            <label for="questionText">Текст питання *</label>
                            <textarea id="questionText" rows="3" placeholder="Введіть текст питання" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="questionType">Тип питання *</label>
                            <select id="questionType" required>
                                <option value="single">Один варіант відповіді</option>
                                <option value="multiple">Кілька варіантів відповіді</option>
                                <option value="text">Текстова відповідь</option>
                            </select>
                        </div>
                        <div id="answersContainerModal">
                            <!-- Варіанти відповідей завантажуються динамічно -->
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary modal-close" onclick="closeModal()">Скасувати</button>
                    <button class="btn-primary" id="saveQuestionBtn">Зберегти питання</button>
                </div>
            </div>
        </div>
        
        <!-- Футер -->
        <footer class="footer">
            <div class="footer-content">
                <p><i class="fas fa-copyright"></i> 2024 Тестування GTA 5 • Система тестування модерації</p>
                <p class="footer-note">
                    <i class="fas fa-shield-alt"></i> Захищена система • Конфіденційність даних
                </p>
            </div>
        </footer>
    </div>

    <!-- Firebase SDK та весь JavaScript в одному файлі -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    
    <script>
    // ===== FIREBASE КОНФІГУРАЦІЯ =====
    const firebaseConfig = {
        apiKey: "AIzaSyBIDJi9eP7BQpx3Y5XFBec-wBj-YXXn5A0",
        authDomain: "testing-ds-moderation.firebaseapp.com",
        databaseURL: "https://testing-ds-moderation-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "testing-ds-moderation",
        storageBucket: "testing-ds-moderation.firebasestorage.app",
        messagingSenderId: "539887798938",
        appId: "1:539887798938:web:6430d916baaa75c78ced23",
        measurementId: "G-P6NYBFB8PQ"
    };

    // Ініціалізація Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const database = firebase.database();

    // Адмін email-и
    const ADMIN_EMAILS = [
        'nazar79parhuts@gmail.com',
        'dan.0985850201@gmail.com'
    ];

    console.log('✅ Firebase ініціалізовано!');

    // ===== FIREBASE SERVICE =====
    class FirebaseService {
        constructor() {
            this.database = database;
            this.auth = auth;
            this.currentUser = null;
            this.isAdmin = false;
        }

        // === АВТОРИЗАЦІЯ ===
        async register(email, password, userData) {
            try {
                const userCredential = await this.auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                await this.database.ref('users/' + user.uid).set({
                    email: user.email,
                    firstName: userData.firstName,
                    lastName: userData.lastName,
                    createdAt: Date.now(),
                    isAdmin: ADMIN_EMAILS.includes(email)
                });
                
                return { success: true, user };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async login(email, password) {
            try {
                const userCredential = await this.auth.signInWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                const userSnapshot = await this.database.ref('users/' + user.uid).once('value');
                const userData = userSnapshot.val();
                
                this.isAdmin = userData?.isAdmin || false;
                this.currentUser = { 
                    ...user, 
                    ...userData, 
                    uid: user.uid 
                };
                
                return { success: true, user: this.currentUser };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        logout() {
            this.currentUser = null;
            this.isAdmin = false;
            return this.auth.signOut();
        }

        // === ТЕСТИ ===
        async createTest(testData) {
            const testId = this.database.ref().child('tests').push().key;
            const test = {
                id: testId,
                ...testData,
                createdBy: this.currentUser.email,
                createdAt: Date.now(),
                active: true
            };
            
            await this.database.ref('tests/' + testId).set(test);
            return test;
        }

        async getTests() {
            const snapshot = await this.database.ref('tests').once('value');
            const tests = snapshot.val() || {};
            return Object.values(tests).filter(test => test.active);
        }

        async getAllTests() {
            const snapshot = await this.database.ref('tests').once('value');
            const tests = snapshot.val() || {};
            return Object.values(tests);
        }

        async updateTest(testId, testData) {
            await this.database.ref('tests/' + testId).update(testData);
        }

        async deleteTest(testId) {
            await this.database.ref('tests/' + testId).remove();
        }

        // === ПИТАННЯ ===
        async createQuestion(questionData) {
            const questionId = this.database.ref().child('questions').push().key;
            const question = {
                id: questionId,
                ...questionData,
                createdAt: Date.now()
            };
            
            await this.database.ref('questions/' + questionId).set(question);
            return question;
        }

        async getQuestions(testId) {
            const snapshot = await this.database.ref('questions')
                .orderByChild('testId')
                .equalTo(testId)
                .once('value');
            const questions = snapshot.val() || {};
            return Object.values(questions);
        }

        // === РЕЗУЛЬТАТИ ===
        async saveResult(resultData) {
            const resultId = this.database.ref().child('results').push().key;
            const result = {
                id: resultId,
                ...resultData,
                userId: this.currentUser.uid,
                userEmail: this.currentUser.email,
                userName: `${this.currentUser.firstName} ${this.currentUser.lastName}`,
                completedAt: Date.now(),
                status: 'waiting'
            };
            
            await this.database.ref('results/' + resultId).set(result);
            return result;
        }

        async getUserResults() {
            const snapshot = await this.database.ref('results')
                .orderByChild('userId')
                .equalTo(this.currentUser.uid)
                .once('value');
            const results = snapshot.val() || {};
            return Object.values(results).sort((a, b) => b.completedAt - a.completedAt);
        }

        async getAllResults() {
            const snapshot = await this.database.ref('results').once('value');
            const results = snapshot.val() || {};
            return Object.values(results).sort((a, b) => b.completedAt - a.completedAt);
        }

        async updateResultStatus(resultId, status) {
            await this.database.ref('results/' + resultId + '/status').set(status);
        }

        async deleteResult(resultId) {
            await this.database.ref('results/' + resultId).remove();
        }

        // === КОРИСТУВАЧІ ===
        async getAllUsers() {
            const snapshot = await this.database.ref('users').once('value');
            const users = snapshot.val() || {};
            return Object.entries(users).map(([uid, user]) => ({ uid, ...user }));
        }

        async deleteUser(userId) {
            await this.database.ref('users/' + userId).remove();
        }

        // === СИНХРОНІЗАЦІЯ ===
        onAuthStateChanged(callback) {
            return this.auth.onAuthStateChanged(callback);
        }

        onTestsChanged(callback) {
            return this.database.ref('tests').on('value', snapshot => {
                const tests = snapshot.val() || {};
                callback(Object.values(tests).filter(test => test.active));
            });
        }

        onResultsChanged(callback) {
            return this.database.ref('results').on('value', snapshot => {
                const results = snapshot.val() || {};
                callback(Object.values(results).sort((a, b) => b.completedAt - a.completedAt));
            });
        }

        // === ЕКСПОРТ/ІМПОРТ ===
        async exportData() {
            const [tests, questions, results, users] = await Promise.all([
                this.database.ref('tests').once('value'),
                this.database.ref('questions').once('value'),
                this.database.ref('results').once('value'),
                this.database.ref('users').once('value')
            ]);

            return {
                tests: tests.val() || {},
                questions: questions.val() || {},
                results: results.val() || {},
                users: users.val() || {},
                exportedAt: Date.now(),
                exportedBy: this.currentUser.email
            };
        }

        async importData(data) {
            if (!data.tests || !data.questions || !data.results || !data.users) {
                throw new Error('Невірний формат даних');
            }

            await this.database.ref('tests').set(data.tests);
            await this.database.ref('questions').set(data.questions);
            await this.database.ref('results').set(data.results);
            await this.database.ref('users').set(data.users);

            return true;
        }
    }

    // Глобальний екземпляр FirebaseService
    const firebaseService = new FirebaseService();

    // ===== ОСНОВНИЙ КОД ДОДАТКУ =====
    document.addEventListener('DOMContentLoaded', function() {
        console.log('🚀 GTA 5 ТЕСТУВАННЯ - ПОВНА СИСТЕМА');
        
        // Глобальні змінні
        let currentTest = null;
        let testQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let testTimer = null;
        let timeLeft = 0;
        let currentEditingResult = null;
        
        // Ініціалізація
        initApp();
        
        function initApp() {
            console.log('Ініціалізація додатка...');
            
            // Прив'язка основних подій
            bindEvents();
            
            // Перевірка стану авторизації
            checkAuthState();
            
            // Показуємо головну сторінку
            showPage('main');
            
            // Ініціалізація модальних вікон
            initModals();
        }
        
        function bindEvents() {
            console.log('Прив\'язка подій...');
            
            // === ГОЛОВНА СТОРІНКА ===
            const loginBtn = document.getElementById('loginBtn');
            const registerBtn = document.getElementById('registerBtn');
            const backFromLogin = document.getElementById('backFromLogin');
            const backFromRegister = document.getElementById('backFromRegister');
            
            if (loginBtn) loginBtn.addEventListener('click', showLoginForm);
            if (registerBtn) registerBtn.addEventListener('click', showRegisterForm);
            if (backFromLogin) backFromLogin.addEventListener('click', showMainPage);
            if (backFromRegister) backFromRegister.addEventListener('click', showMainPage);
            
            // Форми
            const loginForm = document.getElementById('loginFormElement');
            const registerForm = document.getElementById('registerFormElement');
            
            if (loginForm) loginForm.addEventListener('submit', handleLogin);
            if (registerForm) registerForm.addEventListener('submit', handleRegister);
            
            // === КАБІНЕТ ===
            setTimeout(() => {
                const logoutBtn = document.getElementById('logoutBtn');
                const adminPanelBtn = document.getElementById('adminPanelBtn');
                const newTestBtn = document.getElementById('newTestBtn');
                const toDashboardBtn = document.getElementById('toDashboardBtn');
                const backFromAdmin = document.getElementById('backFromAdmin');
                const backFromTest = document.getElementById('backFromTest');
                
                if (logoutBtn) logoutBtn.addEventListener('click', handleLogout);
                if (adminPanelBtn) adminPanelBtn.addEventListener('click', showAdminPage);
                if (newTestBtn) newTestBtn.addEventListener('click', () => showPage('dashboard'));
                if (toDashboardBtn) toDashboardBtn.addEventListener('click', () => showPage('dashboard'));
                if (backFromAdmin) backFromAdmin.addEventListener('click', () => showPage('dashboard'));
                if (backFromTest) backFromTest.addEventListener('click', backToDashboardFromTest);
            }, 100);
            
            // === ТЕСТ ===
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const finishBtn = document.getElementById('finishBtn');
            
            if (prevBtn) prevBtn.addEventListener('click', prevQuestion);
            if (nextBtn) nextBtn.addEventListener('click', nextQuestion);
            if (finishBtn) finishBtn.addEventListener('click', finishTest);
            
            console.log('✅ Події прив\'язані');
        }
        
        function initModals() {
            // Закриття модалок
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', closeModal);
            });
            
            // Клік по оверлею
            const modalOverlay = document.getElementById('modalOverlay');
            if (modalOverlay) {
                modalOverlay.addEventListener('click', function(e) {
                    if (e.target === this) closeModal();
                });
            }
            
            // Кнопка збереження тесту
            const saveTestBtn = document.getElementById('saveTestBtn');
            if (saveTestBtn) {
                saveTestBtn.addEventListener('click', saveTest);
            }
            
            // Кнопка збереження статусу
            const saveStatusBtn = document.getElementById('saveStatusBtn');
            if (saveStatusBtn) {
                saveStatusBtn.addEventListener('click', saveResultStatus);
            }
        }
        
        function checkAuthState() {
            firebaseService.onAuthStateChanged((user) => {
                if (user) {
                    console.log('✅ Користувач авторизований:', user.email);
                    showPage('dashboard');
                    loadUserData();
                    loadTests();
                    loadUserResults();
                    
                    // Перевіряємо чи адмін
                    if (ADMIN_EMAILS.includes(user.email)) {
                        const adminPanelBtn = document.getElementById('adminPanelBtn');
                        if (adminPanelBtn) adminPanelBtn.style.display = 'flex';
                    }
                } else {
                    console.log('❌ Користувач не авторизований');
                    showPage('main');
                    const adminPanelBtn = document.getElementById('adminPanelBtn');
                    if (adminPanelBtn) adminPanelBtn.style.display = 'none';
                }
            });
        }
        
        // ===== УПРАВЛІННЯ СТОРІНКАМИ =====
        function showPage(pageName) {
            console.log('Перехід на сторінку:', pageName);
            
            const pages = ['main', 'dashboard', 'test', 'results', 'admin'];
            
            pages.forEach(page => {
                const pageElement = document.getElementById(page + 'Page');
                if (pageElement) pageElement.classList.remove('active');
            });
            
            const targetPage = document.getElementById(pageName + 'Page');
            if (targetPage) {
                targetPage.classList.add('active');
                
                // Додаткова логіка
                if (pageName === 'dashboard') {
                    loadUserData();
                    loadTests();
                    loadUserResults();
                } else if (pageName === 'admin') {
                    initAdminPanel();
                }
            }
        }
        
        function showMainPage() {
            showPage('main');
            const buttonsContainer = document.querySelector('.buttons-container');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            
            if (buttonsContainer) buttonsContainer.style.display = 'flex';
            if (loginForm) loginForm.style.display = 'none';
            if (registerForm) registerForm.style.display = 'none';
        }
        
        function showLoginForm() {
            const buttonsContainer = document.querySelector('.buttons-container');
            const loginForm = document.getElementById('loginForm');
            
            if (buttonsContainer) buttonsContainer.style.display = 'none';
            if (loginForm) loginForm.style.display = 'block';
        }
        
        function showRegisterForm() {
            const buttonsContainer = document.querySelector('.buttons-container');
            const registerForm = document.getElementById('registerForm');
            
            if (buttonsContainer) buttonsContainer.style.display = 'none';
            if (registerForm) registerForm.style.display = 'block';
        }
        
        function showAdminPage() {
            showPage('admin');
        }
        
        // ===== АВТОРИЗАЦІЯ =====
        async function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('email')?.value.trim();
            const password = document.getElementById('password')?.value;
            
            if (!email || !password) {
                alert('Заповніть всі поля!');
                return;
            }
            
            const result = await firebaseService.login(email, password);
            if (result.success) {
                alert('Успішний вхід!');
                document.getElementById('loginFormElement').reset();
            } else {
                alert('Помилка входу: ' + result.error);
            }
        }
        
        async function handleRegister(e) {
            e.preventDefault();
            const firstName = document.getElementById('firstName')?.value.trim();
            const lastName = document.getElementById('lastName')?.value.trim();
            const email = document.getElementById('regEmail')?.value.trim();
            const password = document.getElementById('regPassword')?.value;
            const confirmPassword = document.getElementById('confirmPassword')?.value;
            
            if (!firstName || !lastName || !email || !password || !confirmPassword) {
                alert('Заповніть всі поля!');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('Паролі не співпадають!');
                return;
            }
            
            const result = await firebaseService.register(email, password, { firstName, lastName });
            if (result.success) {
                alert('Реєстрація успішна!');
                document.getElementById('registerFormElement').reset();
            } else {
                alert('Помилка реєстрації: ' + result.error);
            }
        }
        
        async function handleLogout() {
            await firebaseService.logout();
            alert('Ви вийшли з системи.');
        }
        
        // ===== ЗАВАНТАЖЕННЯ ДАНИХ =====
        async function loadUserData() {
            const user = firebaseService.currentUser;
            if (!user) return;
            
            const userName = document.getElementById('userName');
            const userEmail = document.getElementById('userEmail');
            const testsPassed = document.getElementById('testsPassed');
            const lastTestDate = document.getElementById('lastTestDate');
            
            if (userName) {
                userName.textContent = `${user.firstName || ''} ${user.lastName || ''}`.trim() || user.email;
            }
            if (userEmail) userEmail.textContent = user.email;
            
            const results = await firebaseService.getUserResults();
            if (testsPassed) testsPassed.textContent = results.length;
            if (lastTestDate) {
                if (results.length > 0) {
                    const lastResult = results[0];
                    const date = new Date(lastResult.completedAt);
                    lastTestDate.textContent = date.toLocaleDateString('uk-UA');
                } else {
                    lastTestDate.textContent = '-';
                }
            }
        }
        
        async function loadTests() {
            try {
                const tests = await firebaseService.getTests();
                displayTests(tests);
            } catch (error) {
                console.error('Помилка завантаження тестів:', error);
            }
        }
        
        function displayTests(tests) {
            const testsList = document.getElementById('testsList');
            if (!testsList) return;
            
            testsList.innerHTML = '';
            
            if (tests.length === 0) {
                testsList.innerHTML = `
                    <div class="loading-tests">
                        <i class="fas fa-book-open"></i>
                        <p>Поки що немає доступних тестів</p>
                    </div>
                `;
                return;
            }
            
            tests.forEach(test => {
                const testCard = document.createElement('div');
                testCard.className = 'test-card';
                testCard.innerHTML = `
                    <div class="test-card-title">${test.name}</div>
                    <div class="test-card-description">${test.description || 'Без опису'}</div>
                    <div class="test-card-meta">
                        <span><i class="fas fa-clock"></i> ${test.time} хв</span>
                        <span><i class="fas fa-question-circle"></i> ${test.questionsCount || 0} питань</span>
                    </div>
                    <button class="test-card-btn" onclick="startTest('${test.id}')">
                        <i class="fas fa-play"></i> Пройти тест
                    </button>
                `;
                testsList.appendChild(testCard);
            });
        }
        
        async function loadUserResults() {
            try {
                const results = await firebaseService.getUserResults();
                displayUserResults(results);
            } catch (error) {
                console.error('Помилка завантаження результатів:', error);
            }
        }
        
        function displayUserResults(results) {
            const resultsList = document.getElementById('resultsList');
            if (!resultsList) return;
            
            resultsList.innerHTML = '';
            
            if (results.length === 0) {
                resultsList.innerHTML = `
                    <div class="empty-row">
                        <i class="fas fa-inbox"></i>
                        <p>У вас ще немає результатів</p>
                    </div>
                `;
                return;
            }
            
            results.forEach(result => {
                const statusClass = {
                    waiting: 'status-waiting',
                    passed: 'status-passed',
                    failed: 'status-failed'
                }[result.status] || 'status-waiting';
                
                const statusText = {
                    waiting: 'ОЧІКУЄ',
                    passed: 'ПРОЙШОВ',
                    failed: 'НЕ ПРОЙШОВ'
                }[result.status] || 'ОЧІКУЄ';
                
                const timeSpent = Math.floor(result.timeSpent / 60) + ':' + (result.timeSpent % 60).toString().padStart(2, '0');
                const date = new Date(result.completedAt).toLocaleDateString();
                
                const row = document.createElement('div');
                row.className = 'result-row';
                row.innerHTML = `
                    <div>${result.testName}</div>
                    <div>${date}</div>
                    <div>${timeSpent}</div>
                    <div class="${statusClass}">${statusText}</div>
                `;
                resultsList.appendChild(row);
            });
        }
        
        // ===== СИСТЕМА ТЕСТУВАННЯ =====
        window.startTest = async function(testId) {
            try {
                const tests = await firebaseService.getTests();
                currentTest = tests.find(t => t.id === testId);
                
                if (!currentTest) {
                    alert('Тест не знайдено!');
                    return;
                }
                
                testQuestions = await firebaseService.getQuestions(testId);
                
                if (testQuestions.length === 0) {
                    alert('Для цього тесту ще немає питань!');
                    return;
                }
                
                // Перемішуємо питання
                testQuestions = [...testQuestions].sort(() => Math.random() - 0.5);
                
                currentQuestionIndex = 0;
                userAnswers = new Array(testQuestions.length).fill(null);
                timeLeft = (currentTest.time || 30) * 60;
                
                // Оновлюємо інтерфейс
                document.getElementById('testTitle').textContent = currentTest.name;
                startTimer();
                loadQuestion();
                showPage('test');
                
            } catch (error) {
                alert('Помилка завантаження тесту: ' + error.message);
            }
        };
        
        function startTimer() {
            clearInterval(testTimer);
            updateTimerDisplay();
            
            testTimer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(testTimer);
                    finishTest();
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        function loadQuestion() {
            if (!testQuestions[currentQuestionIndex]) return;
            
            const question = testQuestions[currentQuestionIndex];
            
            document.getElementById('questionNumber').textContent = `ПИТАННЯ ${currentQuestionIndex + 1}`;
            document.getElementById('questionCounter').textContent = `${currentQuestionIndex + 1}/${testQuestions.length}`;
            document.getElementById('questionText').textContent = question.text;
            
            const progress = ((currentQuestionIndex + 1) / testQuestions.length) * 100;
            document.getElementById('progressPercent').textContent = `${Math.round(progress)}%`;
            document.getElementById('progressFill').style.width = `${progress}%`;
            
            const answersContainer = document.getElementById('answersContainer');
            answersContainer.innerHTML = '';
            
            if (question.type === 'single') {
                createSingleChoiceQuestion(question);
            } else if (question.type === 'multiple') {
                createMultipleChoiceQuestion(question);
            } else if (question.type === 'text') {
                createTextQuestion(question);
            }
            
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === testQuestions.length - 1) {
                document.getElementById('nextBtn').style.display = 'none';
                document.getElementById('finishBtn').style.display = 'flex';
            } else {
                document.getElementById('nextBtn').style.display = 'flex';
                document.getElementById('finishBtn').style.display = 'none';
            }
        }
        
        function createSingleChoiceQuestion(question) {
            question.answers.forEach((answer, index) => {
                const option = document.createElement('div');
                option.className = `answer-option ${userAnswers[currentQuestionIndex] === index ? 'selected' : ''}`;
                option.innerHTML = `
                    <div class="option-marker">${String.fromCharCode(65 + index)}</div>
                    <div class="answer-text">${answer.text}</div>
                `;
                option.addEventListener('click', () => {
                    userAnswers[currentQuestionIndex] = index;
                    loadQuestion();
                });
                document.getElementById('answersContainer').appendChild(option);
            });
        }
        
        function createMultipleChoiceQuestion(question) {
            question.answers.forEach((answer, index) => {
                const isSelected = Array.isArray(userAnswers[currentQuestionIndex]) && 
                                  userAnswers[currentQuestionIndex].includes(index);
                const option = document.createElement('div');
                option.className = `answer-option ${isSelected ? 'selected' : ''}`;
                option.innerHTML = `
                    <div class="option-marker">${String.fromCharCode(65 + index)}</div>
                    <div class="answer-text">${answer.text}</div>
                `;
                option.addEventListener('click', () => {
                    if (!Array.isArray(userAnswers[currentQuestionIndex])) {
                        userAnswers[currentQuestionIndex] = [];
                    }
                    
                    const idx = userAnswers[currentQuestionIndex].indexOf(index);
                    if (idx === -1) {
                        userAnswers[currentQuestionIndex].push(index);
                    } else {
                        userAnswers[currentQuestionIndex].splice(idx, 1);
                    }
                    
                    loadQuestion();
                });
                document.getElementById('answersContainer').appendChild(option);
            });
        }
        
        function createTextQuestion(question) {
            const textarea = document.createElement('textarea');
            textarea.placeholder = 'Введіть вашу відповідь тут...';
            textarea.value = userAnswers[currentQuestionIndex] || '';
            textarea.addEventListener('input', (e) => {
                userAnswers[currentQuestionIndex] = e.target.value;
            });
            document.getElementById('answersContainer').appendChild(textarea);
            document.getElementById('answersContainer').classList.add('text-answer');
        }
        
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }
        
        function nextQuestion() {
            if (currentQuestionIndex < testQuestions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            }
        }
        
        async function finishTest() {
            clearInterval(testTimer);
            
            if (!currentTest) return;
            
            try {
                const resultData = {
                    testId: currentTest.id,
                    testName: currentTest.name,
                    userAnswers: userAnswers,
                    timeSpent: (currentTest.time * 60) - timeLeft,
                    questions: testQuestions
                };
                
                const result = await firebaseService.saveResult(resultData);
                
                // Оновлюємо сторінку результатів
                document.getElementById('detailTestName').textContent = result.testName;
                document.getElementById('detailDate').textContent = new Date(result.completedAt).toLocaleDateString('uk-UA');
                
                const minutesUsed = Math.floor(result.timeSpent / 60);
                const secondsUsed = result.timeSpent % 60;
                document.getElementById('detailTime').textContent = 
                    `${minutesUsed}:${secondsUsed.toString().padStart(2, '0')}`;
                
                showPage('results');
                loadUserResults();
                
            } catch (error) {
                alert('Помилка збереження результату: ' + error.message);
                showPage('dashboard');
            }
        }
        
        function backToDashboardFromTest() {
            if (confirm('Вийти з тесту? Прогрес буде втрачено.')) {
                clearInterval(testTimer);
                showPage('dashboard');
            }
        }
        
        // ===== АДМІН-ПАНЕЛЬ =====
        function initAdminPanel() {
            console.log('Ініціалізація адмін-панелі');
            
            const user = firebaseService.currentUser;
            if (!user || !ADMIN_EMAILS.includes(user.email)) {
                alert('Доступ заборонено!');
                showPage('dashboard');
                return;
            }
            
            loadAdminStatistics();
            loadAdminUsers();
            loadAdminTests();
            loadAdminResults();
            initAdminEvents();
            updateSyncStatus();
        }
        
        function initAdminEvents() {
            // Таби
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchAdminTab(tabId);
                });
            });
            
            // Кнопка додавання тесту
            const addTestBtn = document.getElementById('addTestBtn');
            if (addTestBtn) {
                addTestBtn.addEventListener('click', () => showTestModal());
            }
            
            // Пошук користувачів
            const userSearch = document.getElementById('userSearch');
            if (userSearch) {
                userSearch.addEventListener('input', filterAdminUsers);
            }
            
            // Пошук результатів
            const resultSearch = document.getElementById('resultSearch');
            if (resultSearch) {
                resultSearch.addEventListener('input', filterAdminResults);
            }
        }
        
        function switchAdminTab(tabId) {
            // Оновлюємо активні кнопки
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = document.querySelector(`.tab-btn[data-tab="${tabId}"]`);
            if (activeBtn) activeBtn.classList.add('active');
            
            // Оновлюємо контенти
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            const activeTab = document.getElementById(`tab-${tabId}`);
            if (activeTab) activeTab.classList.add('active');
            
            // Оновлюємо дані для активної вкладки
            if (tabId === 'users') {
                loadAdminUsers();
            } else if (tabId === 'tests') {
                loadAdminTests();
            } else if (tabId === 'results') {
                loadAdminResults();
            } else if (tabId === 'sync') {
                updateSyncStatus();
            }
        }
        
        async function loadAdminStatistics() {
            try {
                const [users, tests, results] = await Promise.all([
                    firebaseService.getAllUsers(),
                    firebaseService.getAllTests(),
                    firebaseService.getAllResults()
                ]);
                
                const activeTests = tests.filter(test => test.active);
                
                document.getElementById('adminUsersCount').textContent = users.length;
                document.getElementById('adminTestsCount').textContent = activeTests.length;
                document.getElementById('adminResultsCount').textContent = results.length;
                
                // Оновлюємо статистику синхронізації
                document.getElementById('onlineUsers').textContent = users.length;
                document.getElementById('activeTests').textContent = activeTests.length;
                document.getElementById('lastSyncTime').textContent = new Date().toLocaleTimeString();
                
            } catch (error) {
                console.error('Помилка завантаження статистики:', error);
            }
        }
        
        async function loadAdminUsers() {
            try {
                const users = await firebaseService.getAllUsers();
                const usersList = document.getElementById('usersList');
                
                if (!usersList) return;
                
                usersList.innerHTML = '';
                
                if (users.length === 0) {
                    usersList.innerHTML = '<div class="empty-state">Користувачів не знайдено</div>';
                    return;
                }
                
                users.forEach(user => {
                    const isAdminUser = ADMIN_EMAILS.includes(user.email);
                    const item = document.createElement('div');
                    item.className = 'admin-item';
                    item.innerHTML = `
                        <div class="item-info">
                            <div class="item-title">
                                ${user.firstName || ''} ${user.lastName || ''}
                                ${isAdminUser ? ' <span style="color: #ffd700;">👑</span>' : ''}
                            </div>
                            <div class="item-details">
                                <span><i class="fas fa-envelope"></i> ${user.email}</span>
                                <span><i class="fas fa-calendar"></i> ${user.createdAt ? new Date(user.createdAt).toLocaleDateString() : 'Невідомо'}</span>
                                <span><i class="fas fa-chart-bar"></i> Адмін: ${isAdminUser ? 'Так' : 'Ні'}</span>
                            </div>
                        </div>
                        ${!isAdminUser ? `
                        <div class="item-actions">
                            <button class="btn-sm btn-delete" onclick="deleteUser('${user.uid}')">
                                <i class="fas fa-trash"></i> Видалити
                            </button>
                        </div>
                        ` : ''}
                    `;
                    usersList.appendChild(item);
                });
            } catch (error) {
                console.error('Помилка завантаження користувачів:', error);
                document.getElementById('usersList').innerHTML = 
                    '<div class="empty-state">Помилка завантаження</div>';
            }
        }
        
        async function loadAdminTests() {
            try {
                const tests = await firebaseService.getAllTests();
                const testsAdminList = document.getElementById('testsAdminList');
                
                if (!testsAdminList) return;
                
                testsAdminList.innerHTML = '';
                
                if (tests.length === 0) {
                    testsAdminList.innerHTML = '<div class="empty-state">Тестів не знайдено</div>';
                    return;
                }
                
                tests.forEach(test => {
                    const item = document.createElement('div');
                    item.className = 'admin-item';
                    item.innerHTML = `
                        <div class="item-info">
                            <div class="item-title">
                                ${test.name} 
                                <span class="${test.active ? 'status-passed' : 'status-failed'}" style="font-size: 0.8em; margin-left: 10px;">
                                    ${test.active ? 'АКТИВНИЙ' : 'НЕАКТИВНИЙ'}
                                </span>
                            </div>
                            <div class="item-details">
                                <span><i class="fas fa-clock"></i> ${test.time || 30} хв</span>
                                <span><i class="fas fa-question-circle"></i> ${test.questionsCount || 0} питань</span>
                                <span><i class="fas fa-user"></i> ${test.createdBy || 'Невідомо'}</span>
                                <span><i class="fas fa-calendar"></i> ${test.createdAt ? new Date(test.createdAt).toLocaleDateString() : 'Невідомо'}</span>
                            </div>
                        </div>
                        <div class="item-actions">
                            <button class="btn-sm btn-edit" onclick="editTest('${test.id}')">
                                <i class="fas fa-edit"></i> Редагувати
                            </button>
                            <button class="btn-sm btn-delete" onclick="deleteTest('${test.id}')">
                                <i class="fas fa-trash"></i> Видалити
                            </button>
                        </div>
                    `;
                    testsAdminList.appendChild(item);
                });
            } catch (error) {
                console.error('Помилка завантаження тестів:', error);
            }
        }
        
        async function loadAdminResults() {
            try {
                const results = await firebaseService.getAllResults();
                const resultsAdminList = document.getElementById('resultsAdminList');
                
                if (!resultsAdminList) return;
                
                resultsAdminList.innerHTML = '';
                
                if (results.length === 0) {
                    resultsAdminList.innerHTML = '<div class="empty-state">Результатів не знайдено</div>';
                    return;
                }
                
                window.adminResults = results; // Зберігаємо для фільтрації
                
                displayAdminResults(results);
            } catch (error) {
                console.error('Помилка завантаження результатів:', error);
            }
        }
        
        function displayAdminResults(results) {
            const resultsAdminList = document.getElementById('resultsAdminList');
            if (!resultsAdminList) return;
            
            resultsAdminList.innerHTML = '';
            
            results.forEach(result => {
                const statusClass = {
                    waiting: 'status-waiting',
                    passed: 'status-passed',
                    failed: 'status-failed'
                }[result.status] || 'status-waiting';
                
                const statusText = {
                    waiting: '🟡 Очікує',
                    passed: '🟢 Пройшов',
                    failed: '🔴 Не пройшов'
                }[result.status] || 'Очікує';
                
                const timeSpent = Math.floor(result.timeSpent / 60) + ':' + (result.timeSpent % 60).toString().padStart(2, '0');
                const date = new Date(result.completedAt).toLocaleDateString();
                
                const item = document.createElement('div');
                item.className = 'admin-item';
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-title">${result.testName}</div>
                        <div class="item-details">
                            <span><i class="fas fa-user"></i> ${result.userName}</span>
                            <span><i class="fas fa-envelope"></i> ${result.userEmail}</span>
                            <span><i class="fas fa-calendar"></i> ${date}</span>
                            <span><i class="fas fa-clock"></i> ${timeSpent}</span>
                            <span class="${statusClass}">${statusText}</span>
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="btn-sm btn-view" onclick="viewResult('${result.id}')">
                            <i class="fas fa-eye"></i> Переглянути
                        </button>
                        <button class="btn-sm btn-status" onclick="changeResultStatus('${result.id}')">
                            <i class="fas fa-edit"></i> Статус
                        </button>
                        <button class="btn-sm btn-delete" onclick="deleteResult('${result.id}')">
                            <i class="fas fa-trash"></i> Видалити
                        </button>
                    </div>
                `;
                resultsAdminList.appendChild(item);
            });
        }
        
        function filterAdminUsers() {
            const searchTerm = document.getElementById('userSearch').value.toLowerCase();
            const usersList = document.getElementById('usersList');
            
            if (!usersList) return;
            
            const items = usersList.querySelectorAll('.admin-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(searchTerm) ? 'flex' : 'none';
            });
        }
        
        function filterAdminResults() {
            const searchTerm = document.getElementById('resultSearch').value.toLowerCase();
            const results = window.adminResults || [];
            
            const filteredResults = results.filter(result => 
                result.testName.toLowerCase().includes(searchTerm) ||
                result.userName.toLowerCase().includes(searchTerm) ||
                result.userEmail.toLowerCase().includes(searchTerm) ||
                result.status.toLowerCase().includes(searchTerm)
            );
            
            displayAdminResults(filteredResults);
        }
        
        function updateSyncStatus() {
            const statusElement = document.getElementById('firebaseStatus');
            const statusText = document.getElementById('firebaseStatusText');
            
            if (!statusElement || !statusText) return;
            
            const connectedRef = database.ref('.info/connected');
            connectedRef.on('value', (snap) => {
                if (snap.val() === true) {
                    statusElement.innerHTML = '<span class="status-dot online"></span><span>Підключено</span>';
                    statusText.textContent = 'База даних синхронізована в реальному часі';
                } else {
                    statusElement.innerHTML = '<span class="status-dot offline"></span><span>Не підключено</span>';
                    statusText.textContent = 'Відсутнє підключення до Firebase';
                }
            });
        }
        
        // ===== МОДАЛЬНІ ВІКНА =====
        function showTestModal(testId = null) {
            const modalOverlay = document.getElementById('modalOverlay');
            const testModal = document.getElementById('testModal');
            const modalTitle = document.getElementById('modalTitle');
            
            if (!modalOverlay || !testModal) return;
            
            if (testId) {
                modalTitle.textContent = 'Редагувати тест';
                loadTestData(testId);
            } else {
                modalTitle.textContent = 'Новий тест';
                document.getElementById('testForm').reset();
                document.getElementById('testId').value = '';
                document.getElementById('testActive').checked = true;
            }
            
            modalOverlay.style.display = 'flex';
            testModal.style.display = 'block';
        }
        
        async function loadTestData(testId) {
            try {
                const tests = await firebaseService.getAllTests();
                const test = tests.find(t => t.id === testId);
                
                if (test) {
                    document.getElementById('testId').value = test.id;
                    document.getElementById('testName').value = test.name;
                    document.getElementById('testDescription').value = test.description || '';
                    document.getElementById('testTime').value = test.time || 30;
                    document.getElementById('testQuestions').value = test.questionsCount || 10;
                    document.getElementById('testActive').checked = test.active !== false;
                }
            } catch (error) {
                console.error('Помилка завантаження тесту:', error);
            }
        }
        
        async function saveTest() {
            try {
                const testId = document.getElementById('testId').value;
                const testName = document.getElementById('testName').value.trim();
                const testDescription = document.getElementById('testDescription').value.trim();
                const testTime = parseInt(document.getElementById('testTime').value);
                const testQuestions = parseInt(document.getElementById('testQuestions').value);
                const testActive = document.getElementById('testActive').checked;
                
                if (!testName || !testTime || !testQuestions) {
                    alert('Заповніть обов\'язкові поля!');
                    return;
                }
                
                const testData = {
                    name: testName,
                    description: testDescription,
                    time: testTime,
                    questionsCount: testQuestions,
                    active: testActive
                };
                
                if (testId) {
                    await firebaseService.updateTest(testId, testData);
                    alert('Тест оновлено!');
                } else {
                    await firebaseService.createTest(testData);
                    alert('Тест створено!');
                }
                
                closeModal();
                loadAdminTests();
                loadAdminStatistics();
                loadTests(); // Оновлюємо тести в кабінеті
                
            } catch (error) {
                alert('Помилка збереження тесту: ' + error.message);
            }
        }
        
        async function changeResultStatus(resultId) {
            try {
                const results = await firebaseService.getAllResults();
                const result = results.find(r => r.id === resultId);
                
                if (!result) {
                    alert('Результат не знайдено!');
                    return;
                }
                
                currentEditingResult = resultId;
                
                const statusInfo = document.getElementById('statusInfo');
                if (statusInfo) {
                    statusInfo.innerHTML = `
                        <p><strong>Тест:</strong> ${result.testName}</p>
                        <p><strong>Користувач:</strong> ${result.userName}</p>
                        <p><strong>Дата:</strong> ${new Date(result.completedAt).toLocaleDateString()}</p>
                        <p><strong>Час:</strong> ${Math.floor(result.timeSpent / 60)}:${(result.timeSpent % 60).toString().padStart(2, '0')}</p>
                        <p><strong>Поточний статус:</strong> ${result.status === 'waiting' ? '🟡 Очікує' : result.status === 'passed' ? '🟢 Пройшов' : '🔴 Не пройшов'}</p>
                    `;
                }
                
                const statusSelect = document.getElementById('statusSelect');
                if (statusSelect) {
                    statusSelect.value = result.status;
                }
                
                const modalOverlay = document.getElementById('modalOverlay');
                const statusModal = document.getElementById('statusModal');
                
                if (modalOverlay && statusModal) {
                    modalOverlay.style.display = 'flex';
                    statusModal.style.display = 'block';
                }
                
            } catch (error) {
                alert('Помилка завантаження результату: ' + error.message);
            }
        }
        
        async function saveResultStatus() {
            if (!currentEditingResult) return;
            
            try {
                const newStatus = document.getElementById('statusSelect').value;
                await firebaseService.updateResultStatus(currentEditingResult, newStatus);
                
                alert('Статус змінено!');
                closeModal();
                loadAdminResults();
                loadUserResults(); // Оновлюємо результати в кабінеті
                
            } catch (error) {
                alert('Помилка зміни статусу: ' + error.message);
            }
        }
        
        function closeModal() {
            const modalOverlay = document.getElementById('modalOverlay');
            if (modalOverlay) {
                modalOverlay.style.display = 'none';
            }
            
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
            
            currentEditingResult = null;
        }
        
        // ===== ГЛОБАЛЬНІ ФУНКЦІЇ ДЛЯ HTML =====
        window.filterUsers = filterAdminUsers;
        window.filterResults = filterAdminResults;
        
        window.forceSync = function() {
            alert('🔄 Синхронізація запущена...');
            loadAdminStatistics();
            loadAdminUsers();
            loadAdminTests();
            loadAdminResults();
            alert('✅ Синхронізація завершена!');
        };
        
        window.exportToJSON = async function() {
            try {
                const data = await firebaseService.exportData();
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `gta5_testing_backup_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('✅ Дані експортовано у файл JSON!');
            } catch (error) {
                alert('❌ Помилка експорту: ' + error.message);
            }
        };
        
        window.importFromJSON = function() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                if (!confirm('⚠️ УВАГА! Завантажити ці дані? Всі поточні дані будуть замінені.')) return;
                
                const reader = new FileReader();
                reader.onload = async (event) => {
                    try {
                        const data = JSON.parse(event.target.result);
                        
                        await firebaseService.importData(data);
                        alert('✅ Дані успішно імпортовано!');
                        location.reload();
                        
                    } catch (error) {
                        alert('❌ Помилка імпорту: ' + error.message);
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        };
        
        window.closeModal = closeModal;
        
        window.deleteUser = async function(userId) {
            if (!confirm('Видалити користувача? Всі його результати також будуть видалені.')) return;
            
            try {
                await firebaseService.deleteUser(userId);
                alert('✅ Користувача видалено!');
                loadAdminUsers();
                loadAdminStatistics();
            } catch (error) {
                alert('❌ Помилка видалення: ' + error.message);
            }
        };
        
        window.editTest = function(testId) {
            showTestModal(testId);
        };
        
        window.deleteTest = async function(testId) {
            if (!confirm('Видалити тест? Всі пов\'язані питання та результати також будуть видалені.')) return;
            
            try {
                await firebaseService.deleteTest(testId);
                alert('✅ Тест видалено!');
                loadAdminTests();
                loadAdminStatistics();
                loadTests();
            } catch (error) {
                alert('❌ Помилка видалення: ' + error.message);
            }
        };
        
        window.viewResult = async function(resultId) {
            try {
                const results = await firebaseService.getAllResults();
                const result = results.find(r => r.id === resultId);
                
                if (!result) {
                    alert('Результат не знайдено!');
                    return;
                }
                
                let message = `📊 ТЕСТ: ${result.testName}\n`;
                message += `👤 КОРИСТУВАЧ: ${result.userName}\n`;
                message += `📧 EMAIL: ${result.userEmail}\n`;
                message += `📅 ДАТА: ${new Date(result.completedAt).toLocaleString()}\n`;
                message += `⏱️ ЧАС: ${Math.floor(result.timeSpent / 60)}:${(result.timeSpent % 60).toString().padStart(2, '0')}\n`;
                message += `📈 СТАТУС: ${result.status === 'waiting' ? '🟡 Очікує' : result.status === 'passed' ? '🟢 Пройшов' : '🔴 Не пройшов'}\n\n`;
                message += '📝 ВІДПОВІДІ:\n\n';
                
                if (result.questions && result.userAnswers) {
                    result.questions.forEach((question, index) => {
                        message += `${index + 1}. ${question.text}\n`;
                        
                        if (question.type === 'text') {
                            message += `   Відповідь: ${result.userAnswers[index] || '(пусто)'}\n\n`;
                        } else if (Array.isArray(result.userAnswers[index])) {
                            const answers = result.userAnswers[index]
                                .map(a => String.fromCharCode(65 + a))
                                .join(', ');
                            message += `   Вибрані варіанти: ${answers || '(нічого)'}\n\n`;
                        } else if (result.userAnswers[index] !== null && result.userAnswers[index] !== undefined) {
                            message += `   Вибрані варіант: ${String.fromCharCode(65 + result.userAnswers[index])}\n\n`;
                        } else {
                            message += `   Не відповів\n\n`;
                        }
                    });
                } else {
                    message += 'Деталі відповідей відсутні\n';
                }
                
                alert(message);
            } catch (error) {
                alert('Помилка перегляду результату: ' + error.message);
            }
        };
        
        window.changeResultStatus = changeResultStatus;
        
        window.deleteResult = async function(resultId) {
            if (!confirm('Видалити результат?')) return;
            
            try {
                await firebaseService.deleteResult(resultId);
                alert('✅ Результат видалено!');
                loadAdminResults();
                loadAdminStatistics();
            } catch (error) {
                alert('❌ Помилка видалення: ' + error.message);
            }
        };
        
        console.log('✅ ПОВНА СИСТЕМА ТЕСТУВАННЯ GTA 5 ГОТОВА!');
    });
    </script>
</body>
</html>
