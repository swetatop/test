<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Military Academy / UG5</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <style>
        /* –í–ê–® –£–ù–ò–ö–ê–õ–¨–ù–´–ô –°–¢–ò–õ–¨ */
        :root {
            --bg: #0D0F15;
            --card: #1A1D25;
            --accent: #2A2E3A;
            --text: #FFFFFF;
            --primary: linear-gradient(135deg, #5D8C42 0%, #3A5C2A 100%);
            --primary-hover: linear-gradient(135deg, #6D9C52 0%, #4A6C3A 100%);
            --card-gradient: linear-gradient(135deg, #151820 0%, #2A3A1A 100%);
            --card-gradient-hover: linear-gradient(135deg, #252830 0%, #3A4A2A 100%);
            --text-gray: #CCCCCC;
            --success: #4CAF50;
            --error: #f44336;
            --link-color: #6D9C52;
            --link-hover: #7DAC62;
            --warning: #ff9800;
            --info: #2196F3;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            padding-bottom: 60px;
            font-family: 'Inter', Arial, sans-serif;
        }
        
        h1, h2, h3, h4 {
            font-family: 'Inter', Arial, sans-serif;
            color: #FFFFFF;
        }
        
        h1 { font-weight: 700; font-size: 2.5rem; }
        h2 { font-weight: 600; font-size: 2rem; }
        h3 { font-weight: 500; font-size: 1.5rem; }
        
        /* üî• –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 3000;
            animation: slideIn 0.3s ease;
            max-width: 400px;
            word-wrap: break-word;
            font-weight: 500;
        }
        
        .notification.success {
            background: var(--success);
            color: white;
        }
        
        .notification.error {
            background: var(--error);
            color: white;
        }
        
        .notification.warning {
            background: var(--warning);
            color: black;
        }
        
        .notification.info {
            background: var(--primary);
            color: white;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* üîî –°–ò–°–¢–ï–ú–ê –û–ü–û–í–ï–©–ï–ù–ò–ô */
        .alert-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 15px 20px;
            z-index: 2000;
            display: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border-bottom: 2px solid #5d8c42;
        }

        .alert-banner.active {
            display: flex;
            align-items: center;
            justify-content: space-between;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .alert-content {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .alert-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .alert-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.4;
        }

        .alert-buttons {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }

        .alert-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .alert-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* User Panel */
        .user-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-info {
            background: var(--primary);
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 14px;
            color: #FFFFFF;
        }
        
        .admin-button {
            background: var(--primary);
            border: none;
            color: var(--text);
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .admin-button:hover {
            background: var(--primary-hover);
        }
        
        .login-button {
            background: var(--primary);
            border: none;
            color: var(--text);
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .login-button:hover {
            background: var(--primary-hover);
        }
        
        /* Admin Panel */
        .admin-panel {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-gradient);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            z-index: 2001;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
        }
        
        .admin-panel.active {
            display: block;
        }
        
        .admin-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }
        
        .admin-overlay.active {
            display: block;
        }
        
        .users-info {
            background: rgba(13, 15, 21, 0.6);
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
            border-left: 4px solid #6D9C52;
        }
        
        .users-info p {
            margin: 5px 0;
            font-size: 14px;
            color: #FFFFFF;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–æ–≤ */
        .logs-section {
            background: var(--card-gradient);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .logs-list {
            max-height: 300px;
            overflow-y: auto;
            background: rgba(26, 29, 37, 0.6);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .log-item {
            padding: 10px 12px;
            margin-bottom: 8px;
            background: rgba(42, 46, 58, 0.8);
            border-radius: 6px;
            border-left: 4px solid #6D9C52;
            font-size: 13px;
            transition: all 0.3s ease;
            color: #FFFFFF;
        }
        
        .log-item:hover {
            background: rgba(42, 46, 58, 0.9);
            transform: translateX(2px);
        }
        
        .log-time {
            color: var(--text-gray);
            font-size: 11px;
            margin-right: 10px;
        }
        
        .log-user {
            color: #6D9C52;
            font-weight: bold;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .add-card-btn {
            background: var(--primary);
            color: var(--text);
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .add-card-btn:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .delete-card-btn {
            background: var(--error);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
            opacity: 0;
            transition: all 0.3s ease;
            position: absolute;
            top: 10px;
            right: 10px;
        }
        
        .chapter-card:hover .delete-card-btn {
            opacity: 1;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .card-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }
        
        .card-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .card-modal-content {
            background: var(--card-gradient);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
        }
        
        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100vh;
            background: rgba(26, 29, 37, 0.95);
            backdrop-filter: blur(10px);
            transition: left 0.3s ease;
            z-index: 1000;
            padding: 20px;
            border-right: 1px solid rgba(255,255,255,0.1);
        }
        
        .sidebar.active {
            left: 0;
        }
        
        .sidebar.active ~ .menu-toggle {
            left: 260px;
            transition: left 0.3s ease;
        }
        
        .menu-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary);
            border: none;
            color: var(--text);
            font-size: 16px;
            padding: 10px 15px;
            cursor: pointer;
            z-index: 1001;
            border-radius: 6px;
            transition: all 0.3s;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .menu-toggle:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }
        
        .sidebar h2 {
            color: var(--text);
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.25rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 10px;
            margin-top: 0;
        }
        
        .sidebar-nav {
            list-style: none;
            margin-bottom: 30px;
        }
        
        .sidebar-nav li {
            margin-bottom: 10px;
            position: relative;
        }
        
        .sidebar-nav a {
            color: var(--text);
            text-decoration: none;
            font-size: 14px;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-radius: 6px;
            transition: all 0.3s;
            border: 1px solid transparent;
            background: rgba(42, 46, 58, 0.6);
        }
        
        .sidebar-nav a:hover,
        .sidebar-nav a.active {
            background: var(--primary);
            border-color: rgba(255,255,255,0.1);
            transform: translateY(-2px);
        }
        
        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        .discord-link {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .discord-link a {
            color: var(--text);
            text-decoration: none;
            font-size: 14px;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-radius: 6px;
            transition: all 0.3s;
            border: 1px solid transparent;
            background: rgba(42, 46, 58, 0.6);
        }
        
        .discord-link a:hover {
            background: var(--primary);
            border-color: rgba(255,255,255,0.1);
            transform: translateY(-2px);
        }
        
        /* Enhanced Dropdown Styles */
        .dropdown-content {
            display: none;
            position: absolute;
            left: 100%;
            top: 0;
            background: rgba(26, 29, 37, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 15px;
            min-width: 280px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            z-index: 1002;
        }
        
        .dropdown:hover .dropdown-content {
            display: block;
        }
        
        .dropdown-section {
            margin-bottom: 15px;
        }
        
        .dropdown-section:last-child {
            margin-bottom: 0;
        }
        
        .dropdown-section-title {
            color: var(--text-gray);
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 8px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            text-transform: uppercase;
        }
        
        .dropdown-content a {
            margin-bottom: 5px;
            font-size: 13px;
            padding: 8px 12px;
            display: block;
            border-radius: 4px;
            transition: all 0.3s ease;
            color: #FFFFFF;
            text-decoration: none;
        }
        
        .dropdown-content a:hover {
            background: var(--primary);
        }
        
        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 100px 20px 40px;
        }
        
        /* Welcome Section */
        .welcome-section {
            background: var(--card-gradient);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }
        
        .welcome-section h1 {
            color: #FFFFFF;
            margin-bottom: 15px;
            font-size: 2rem;
        }
        
        .welcome-section p {
            color: var(--text-gray);
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* Quick Cards */
        .quick-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }
        
        .card {
            background: var(--card-gradient);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }
        
        .card:hover {
            background: var(--card-gradient-hover);
            border-color: rgba(255,255,255,0.2);
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }
        
        .card h3 {
            font-size: 1.5rem;
            color: #FFFFFF;
        }
        
        /* Pages */
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        /* Chapters Grid */
        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .chapter-card {
            background: var(--card-gradient);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            position: relative;
        }
        
        .chapter-card:hover {
            background: var(--card-gradient-hover);
            transform: translateY(-8px) scale(1.02);
            border-color: rgba(255,255,255,0.2);
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }
        
        .chapter-card h4 {
            font-size: 1.1rem;
            color: #FFFFFF;
            line-height: 1.4;
        }
        
        /* Content Pages */
        .content-page {
            background: rgba(26, 29, 37, 0.8);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 30px;
            margin-top: 20px;
            min-height: 500px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .content-header {
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 20px;
            margin-bottom: 30px;
            position: relative;
        }
        
        .content-body {
            line-height: 1.8;
            color: var(--text-gray);
            margin-bottom: 30px;
            font-family: 'Inter', sans-serif;
        }
        
        .content-body a {
            color: #6D9C52 !important;
            text-decoration: none !important;
            border-bottom: 1px solid #6D9C52;
            transition: all 0.3s ease;
            cursor: pointer !important;
        }
        
        .content-body a:hover {
            color: #7DAC62 !important;
            border-bottom: 1px solid #7DAC62;
        }
        
        .content-body ul, .content-body ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .content-body li {
            margin-bottom: 5px;
            color: #FFFFFF;
        }
        
        .content-body code {
            background: rgba(13, 15, 21, 0.8);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            color: #FFFFFF;
        }
        
        .content-body pre {
            background: rgba(13, 15, 21, 0.8);
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
            color: #FFFFFF;
        }
        
        .content-body blockquote {
            border-left: 4px solid #6D9C52;
            padding-left: 15px;
            margin: 15px 0;
            color: var(--text-gray);
            font-style: italic;
        }
        
        .edit-section {
            background: rgba(42, 46, 58, 0.6);
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
            border-left: 4px solid transparent;
            border-image: var(--primary);
            border-image-slice: 1;
        }
        
        .edit-textarea {
            width: 100%;
            height: 300px;
            background: rgba(13, 15, 21, 0.8);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            color: var(--text);
            padding: 15px;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 15px;
            font-family: 'Inter', sans-serif;
        }
        
        .edit-textarea:focus {
            outline: none;
            border-color: #6D9C52;
            box-shadow: 0 0 10px rgba(109, 156, 82, 0.3);
        }
        
        .edit-button {
            background: var(--primary);
            color: var(--text);
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .edit-button:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }
        
        /* Navigation Buttons */
        .nav-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .nav-btn {
            background: var(--primary);
            color: var(--text);
            border: none;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }
        
        .nav-btn:hover {
            background: var(--primary-hover);
            transform: translateY(-3px);
        }
        
        /* Back Button */
        .back-button {
            background: var(--primary);
            color: var(--text);
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .back-button:hover {
            background: var(--primary-hover);
            transform: translateX(-3px) translateY(-2px);
        }
        
        /* RP Tasks Section */
        .rp-tasks {
            margin-top: 50px;
        }
        
        /* Footer */
        .footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            text-align: center;
            padding: 20px;
            color: var(--text-gray);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            background: rgba(26, 29, 37, 0.8);
            backdrop-filter: blur(10px);
        }
        
        .footer p {
            margin: 0;
            opacity: 0.8;
        }
        
        /* üì± –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 768px) {
            .container {
                padding: 80px 15px 40px;
            }
            
            .user-panel {
                position: static;
                margin-bottom: 20px;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .sidebar {
                width: 250px;
                left: -250px;
            }
            
            .sidebar.active ~ .menu-toggle {
                left: 210px;
            }
            
            .dropdown-content {
                position: static;
                display: none;
                background: rgba(42, 46, 58, 0.8);
                margin-top: 5px;
                border-radius: 6px;
            }
            
            .dropdown.active .dropdown-content {
                display: block;
            }
            
            .editor-toolbar {
                gap: 3px;
                padding: 8px;
                overflow-x: auto;
            }
            
            .editor-btn {
                padding: 6px 8px;
                font-size: 12px;
            }
            
            .quick-cards {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .chapters-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .nav-buttons {
                grid-template-columns: 1fr;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .welcome-section {
                padding: 20px;
            }
            
            .welcome-section h1 {
                font-size: 1.5rem;
            }
            
            .content-page {
                padding: 20px;
            }
            
            .menu-toggle {
                top: 10px;
                left: 10px;
                padding: 8px 12px;
                font-size: 14px;
            }

            .alert-banner {
                padding: 12px 15px;
            }

            .alert-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .alert-buttons {
                align-self: flex-end;
            }
        }
        
        @media (max-width: 480px) {
            .auth-content, .card-modal-content {
                padding: 20px;
                margin: 10px;
            }
            
            .editor-toolbar {
                justify-content: flex-start;
            }
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #6D9C52;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            text-align: center;
            color: var(--text-gray);
            margin-top: 10px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π */
        .content-body img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* WYSIWYG Editor Styles */
        .editor-toolbar {
            background: var(--card);
            border: 1px solid var(--accent);
            border-radius: 8px 8px 0 0;
            padding: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            border-bottom: none;
        }
        
        .editor-btn {
            background: var(--accent);
            border: 1px solid rgba(255,255,255,0.1);
            color: var(--text);
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .editor-btn:hover {
            background: var(--primary);
        }
        
        .editor-content {
            min-height: 300px;
            background: var(--card);
            border: 1px solid var(--accent);
            border-radius: 0 0 8px 8px;
            padding: 15px;
            color: var(--text);
            line-height: 1.6;
            outline: none;
        }

        /* –í–ê–® –£–ù–ò–ö–ê–õ–¨–ù–´–ô BACKGROUND */
        .background-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(42, 46, 58, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(42, 58, 26, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(93, 140, 66, 0.15) 0%, transparent 50%);
            z-index: -1;
        }

        /* Auth Modal */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            backdrop-filter: blur(5px);
        }
        
        .auth-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .auth-content {
            background: var(--card-gradient);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-gray);
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            background: rgba(13, 15, 21, 0.8);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            color: var(--text);
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #6D9C52;
        }
        
        .auth-button {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            border: none;
            border-radius: 6px;
            color: var(--text);
            cursor: pointer;
            margin-top: 10px;
        }
        
        .auth-button:hover {
            background: var(--primary-hover);
        }
        
        .auth-message {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            display: none;
        }
        
        .auth-message.success {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid var(--success);
            display: block;
        }
        
        .auth-message.error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid var(--error);
            display: block;
        }

        /* –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π */
        .add-section-btn {
            background: var(--primary);
            color: var(--text);
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 0;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .add-section-btn:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }

        /* –°–µ–∫—Ü–∏—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ */
        .alerts-management {
            background: var(--card-gradient);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .alerts-list {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(26, 29, 37, 0.6);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .alert-item {
            padding: 10px 12px;
            margin-bottom: 8px;
            background: rgba(42, 46, 58, 0.8);
            border-radius: 6px;
            border-left: 4px solid #2196F3;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <!-- üîî –°–ò–°–¢–ï–ú–ê –û–ü–û–í–ï–©–ï–ù–ò–ô -->
    <div class="alert-banner" id="alert-banner">
        <div class="alert-content">
            <span class="alert-icon">‚ÑπÔ∏è</span>
            <div class="alert-text" id="alert-text"></div>
        </div>
        <div class="alert-buttons">
            <button class="alert-btn" onclick="hideAlertPermanently()">–ë—ñ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏</button>
            <button class="alert-btn" onclick="hideAlert()">–ó–∞–∫—Ä–∏—Ç–∏</button>
        </div>
    </div>

    <!-- –í–ê–® –£–ù–ò–ö–ê–õ–¨–ù–´–ô BACKGROUND -->
    <div class="background-overlay"></div>
    
    <!-- Auth Modal -->
    <div class="auth-modal">
        <div class="auth-content">
            <h3 style="text-align: center; margin-bottom: 20px;">–í—Ö—ñ–¥ –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
            
            <div class="auth-form active" id="login-form">
                <div class="form-group">
                    <label>–õ–æ–≥—ñ–Ω:</label>
                    <input type="text" id="login-username" placeholder="–í–≤–µ–¥—ñ—Ç—å –ª–æ–≥—ñ–Ω">
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="login-password" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å">
                </div>
                <button class="auth-button" onclick="login()">–£–≤—ñ–π—Ç–∏</button>
                <div class="auth-message" id="login-message"></div>
            </div>
        </div>
    </div>

    <!-- Card Creation Modal -->
    <div class="card-modal">
        <div class="card-modal-content">
            <h3 style="text-align: center; margin-bottom: 20px;" id="card-modal-title">–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ä–æ–∑–¥—ñ–ª</h3>
            
            <div class="form-group">
                <label>–¢–∏–ø —Ä–æ–∑–¥—ñ–ª—É:</label>
                <select id="section-type" class="form-group input" style="width: 100%; padding: 10px; background: rgba(13, 15, 21, 0.8); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: var(--text);">
                    <option value="exam">–Ü—Å–ø–∏—Ç</option>
                    <option value="lecture">–õ–µ–∫—Ü—ñ—è</option>
                    <option value="training">–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è</option>
                    <option value="task">–†–ü –ó–∞–≤–¥–∞–Ω–Ω—è</option>
                </select>
            </div>

            <div class="form-group">
                <label>–ù–∞–∑–≤–∞ —Ä–æ–∑–¥—ñ–ª—É:</label>
                <input type="text" id="new-card-title" placeholder="–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: –°—Ç—Ä—ñ–ª—å–±–∞ –∑ –∞–≤—Ç–æ–º–∞—Ç–∞">
            </div>

            <div class="form-group">
                <label>–û–ø–∏—Å —Ä–æ–∑–¥—ñ–ª—É:</label>
                <div class="editor-toolbar">
                    <button class="editor-btn" onclick="formatText('bold')" title="–ñ–∏—Ä–Ω–∏–π"><b>B</b></button>
                    <button class="editor-btn" onclick="formatText('italic')" title="–ö—É—Ä—Å–∏–≤"><i>I</i></button>
                    <button class="editor-btn" onclick="formatText('insertUnorderedList')" title="–ú–∞—Ä–∫–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫">‚â°</button>
                    <button class="editor-btn" onclick="uploadImage()" title="–î–æ–¥–∞—Ç–∏ —Ñ–æ—Ç–æ">üì∑</button>
                </div>
                <div class="editor-content" id="new-card-content" contenteditable="true">
                    –û–ø–∏—à—ñ—Ç—å –∑–º—ñ—Å—Ç —Ä–æ–∑–¥—ñ–ª—É...
                </div>
            </div>
            
            <button class="auth-button" onclick="createNewCard()">–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–æ–∑–¥—ñ–ª</button>
            <button class="auth-button" onclick="closeCardModal()" style="background: var(--error); margin-top: 10px;">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-overlay"></div>
    <div class="admin-panel">
        <h3>–ü–∞–Ω–µ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
        
        <div class="users-info">
            <p><strong>–ü–æ—Ç–æ—á–Ω–∏–π –∞–¥–º—ñ–Ω:</strong> <span id="current-admin">admin</span></p>
        </div>

        <div class="form-group">
            <label>–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</label>
            <input type="text" id="new-username" placeholder="–õ–æ–≥—ñ–Ω –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞">
            <input type="password" id="new-password" placeholder="–ü–∞—Ä–æ–ª—å –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞" style="margin-top: 10px;">
            <button class="auth-button" onclick="addUser()" style="margin-top: 10px;">–î–æ–¥–∞—Ç–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞</button>
        </div>

        <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–ø–æ–≤–µ—â–µ–Ω–∏—è–º–∏ -->
        <div class="alerts-management">
            <h4>üì¢ –ö–µ—Ä—É–≤–∞–Ω–Ω—è –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è–º–∏</h4>
            <div class="form-group">
                <label>–ù–æ–≤–µ –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è:</label>
                <input type="text" id="new-alert-text" placeholder="–ö–æ—Ä–æ—Ç–∫–æ –ø—Ä–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∞–π—Ç—É..." style="margin-bottom: 10px;">
                <button class="auth-button" onclick="createAlert()">–°—Ç–≤–æ—Ä–∏—Ç–∏ –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è</button>
            </div>
            
            <div class="alerts-list" id="alerts-list">
                <!-- –ê—Ä—Ö–∏–≤ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
        
        <div class="logs-section">
            <h4>–û—Å—Ç–∞–Ω–Ω—ñ –¥—ñ—ó –≤ —Å–∏—Å—Ç–µ–º—ñ:</h4>
            <div class="logs-list" id="logs-list">
                <!-- –õ–æ–≥–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
        
        <button class="auth-button" onclick="closeAdminPanel()">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>

    <!-- User Panel -->
    <div class="user-panel">
        <button class="login-button" onclick="showLoginModal()" id="login-btn">–í—Ö—ñ–¥ –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞</button>
        <div class="user-info" id="user-info" style="display: none;"></div>
        <button class="admin-button" onclick="showAdminPanel()" id="admin-btn" style="display: none;">–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</button>
        <button class="admin-button" onclick="logout()" id="logout-btn" style="display: none;">–í–∏–π—Ç–∏</button>
    </div>
    
    <!-- Sidebar Menu -->
    <button class="menu-toggle">‚ò∞ –ú–µ–Ω—é</button>
    
    <div class="sidebar">
        <h2>Military Academy</h2>
        <ul class="sidebar-nav">
            <li><a href="#" class="nav-link active" data-page="home">
                <span class="nav-icon">üè†</span>–ì–æ–ª–æ–≤–Ω–∞
            </a></li>
            <li class="dropdown">
                <a href="#" class="nav-link" data-page="exams">
                    <span class="nav-icon">‚ö°</span>–Ü—Å–ø–∏—Ç–∏
                </a>
                <div class="dropdown-content">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </li>
            <li class="dropdown">
                <a href="#" class="nav-link" data-page="lectures">
                    <span class="nav-icon">üìö</span>–õ–µ–∫—Ü—ñ—ó
                </a>
                <div class="dropdown-content">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </li>
            <li class="dropdown">
                <a href="#" class="nav-link" data-page="training">
                    <span class="nav-icon">üí™</span>–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
                </a>
                <div class="dropdown-content">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </li>
            <li class="dropdown">
                <a href="#" class="nav-link" data-page="tasks">
                    <span class="nav-icon">üéØ</span>–†–ü –ó–∞–≤–¥–∞–Ω–Ω—è
                </a>
                <div class="dropdown-content">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </li>
        </ul>
        
        <div class="discord-link">
            <a href="https://discord.com/users/808726131020791869" target="_blank">
                <span class="nav-icon">üí°</span>–î–ª—è –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É —Ç–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ–π: Discord
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Home Page -->
        <div id="home" class="page active">
            <div class="welcome-section">
                <h1>–®–∞–Ω–æ–≤–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∏!</h1>
                <p>–¶–µ–π —Å–∞–π—Ç —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è –¥–æ–ø–æ–º–æ–≥–∏ —ñ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞–º Military Academy —É –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ —Å–ª—É–∂–±–æ–≤–∏—Ö –æ–±–æ–≤'—è–∑–∫—ñ–≤, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ñ –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö –∑–∞–Ω—è—Ç—å —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤—Ü—ñ –∫—É—Ä—Å–∞–Ω—Ç—ñ–≤.</p>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∞ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ -->
                <div id="admin-add-section" style="display: none;">
                    <button class="add-section-btn" onclick="showCardModal()">
                        ‚ûï –î–æ–¥–∞—Ç–∏ —Ä–æ–∑–¥—ñ–ª
                    </button>
                </div>
            </div>

            <div class="quick-cards">
                <div class="card" data-page="exams">
                    <h3>–Ü—Å–ø–∏—Ç–∏</h3>
                </div>
                <div class="card" data-page="lectures">
                    <h3>–õ–µ–∫—Ü—ñ—ó</h3>
                </div>
                <div class="card" data-page="training">
                    <h3>–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è</h3>
                </div>
                <div class="card" data-page="tasks">
                    <h3>–†–ü –ó–∞–≤–¥–∞–Ω–Ω—è</h3>
                </div>
            </div>
        </div>

        <!-- Exams Page -->
        <div id="exams" class="page">
            <button class="back-button" onclick="showPage('home')">‚Üê –ù–∞–∑–∞–¥ –¥–æ –≥–æ–ª–æ–≤–Ω–æ—ó</button>
            <div class="section-header">
                <h2>–Ü—Å–ø–∏—Ç–∏</h2>
                <button class="add-card-btn" onclick="showExamModal()">
                    ‚ûï –î–æ–¥–∞—Ç–∏ —ñ—Å–ø–∏—Ç
                </button>
            </div>
            <div class="chapters-grid" id="exams-grid">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –∏c–ø–∏—Ç–æ–≤ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>

        <!-- Lectures Page -->
        <div id="lectures" class="page">
            <button class="back-button" onclick="showPage('home')">‚Üê –ù–∞–∑–∞–¥ –¥–æ –≥–æ–ª–æ–≤–Ω–æ—ó</button>
            <div class="section-header">
                <h2>–õ–µ–∫—Ü—ñ—ó</h2>
                <button class="add-card-btn" onclick="showLectureModal()">
                    ‚ûï –î–æ–¥–∞—Ç–∏ –ª–µ–∫—Ü—ñ—é
                </button>
            </div>
            <div class="chapters-grid" id="lectures-grid">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –ª–µ–∫—Ü–∏–π –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>

        <!-- Training Page -->
        <div id="training" class="page">
            <button class="back-button" onclick="showPage('home')">‚Üê –ù–∞–∑–∞–¥ –¥–æ –≥–æ–ª–æ–≤–Ω–æ—ó</button>
            <div class="section-header">
                <h2>–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è</h2>
                <button class="add-card-btn" onclick="showTrainingModal()">
                    ‚ûï –î–æ–¥–∞—Ç–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
                </button>
            </div>
            <div class="chapters-grid" id="training-grid">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>

        <!-- Tasks Page -->
        <div id="tasks" class="page">
            <button class="back-button" onclick="showPage('home')">‚Üê –ù–∞–∑–∞–¥ –¥–æ –≥–æ–ª–æ–≤–Ω–æ—ó</button>
            <div class="section-header">
                <h2>–†–ü –ó–∞–≤–¥–∞–Ω–Ω—è</h2>
                <button class="add-card-btn" onclick="showTaskModal()">
                    ‚ûï –î–æ–¥–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è
                </button>
            </div>
            <div class="chapters-grid" id="tasks-grid">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–¥–∞–Ω–∏–π –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>

        <!-- Content Pages Container -->
        <div id="content-pages"></div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>Ukraine GTA 5 | Army. –°–∞–π—Ç —Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç–≤–æ—Ä–µ–Ω—ñ Danil Perets.</p>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBJU9vxpn6bMQrCIzu4ixuYNAg_TjReNCY",
            authDomain: "us-army-ukraine-gta5.firebaseapp.com",
            databaseURL: "https://us-army-ukraine-gta5-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "us-army-ukraine-gta5",
            storageBucket: "us-army-ukraine-gta5.firebasestorage.app",
            messagingSenderId: "544783269993",
            appId: "1:544783269993:web:55377448115351af7680c"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();

        // User management system
        let currentUser = null;
        let contentStorage = {};
        let systemLogs = [];
        let systemAlerts = [];
        let currentCardType = '';
        let alertTimeout = null;

        // ===== üîî –°–ò–°–¢–ï–ú–ê –û–ü–û–í–ï–©–ï–ù–ò–ô =====
        function loadAlertsFromFirebase() {
            database.ref('systemAlerts').on('value', (snapshot) => {
                const alerts = snapshot.val();
                if (alerts) {
                    systemAlerts = alerts;
                    showActiveAlert();
                    updateAlertsDisplay();
                }
            });
        }

        function showActiveAlert() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ—Ç–∫–ª—é—á–∏–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–æ–≤–µ—â–µ–Ω–∏—è
            if (localStorage.getItem('alertsDisabled') === 'true') return;

            const activeAlert = systemAlerts.find(alert => alert.active && !alert.archived);
            if (activeAlert) {
                document.getElementById('alert-text').textContent = activeAlert.text;
                document.getElementById('alert-banner').classList.add('active');
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
                alertTimeout = setTimeout(() => {
                    hideAlert();
                }, 30000);
            }
        }

        function hideAlert() {
            document.getElementById('alert-banner').classList.remove('active');
            if (alertTimeout) {
                clearTimeout(alertTimeout);
                alertTimeout = null;
            }
        }

        function hideAlertPermanently() {
            hideAlert();
            localStorage.setItem('alertsDisabled', 'true');
            showNotification('–û–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤—ñ–¥–∫–ª—é—á–µ–Ω—ñ', 'info');
        }

        function createAlert() {
            if (!currentUser || currentUser.username !== 'Admin') {
                showNotification('–¢—ñ–ª—å–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á Admin –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è', 'error');
                return;
            }

            const alertText = document.getElementById('new-alert-text').value.trim();
            if (!alertText) {
                showNotification('–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è', 'error');
                return;
            }

            const newAlert = {
                id: Date.now().toString(),
                text: alertText,
                createdBy: currentUser.username,
                createdAt: new Date().toISOString(),
                active: true,
                archived: false
            };

            systemAlerts.push(newAlert);
            database.ref('systemAlerts').set(systemAlerts)
                .then(() => {
                    showNotification('–û–ø–æ–≤—ñ—â–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–æ!', 'success');
                    document.getElementById('new-alert-text').value = '';
                    addSystemLog('alert_created', `–°—Ç–≤–æ—Ä–µ–Ω–æ –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è: ${alertText.substring(0, 50)}...`);
                    showActiveAlert();
                })
                .catch(error => {
                    showNotification('–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è', 'error');
                    console.error('Alert creation error:', error);
                });
        }

        function updateAlertsDisplay() {
            const alertsList = document.getElementById('alerts-list');
            if (!alertsList) return;

            const activeAlerts = systemAlerts.filter(alert => !alert.archived);
            
            if (activeAlerts.length === 0) {
                alertsList.innerHTML = '<p style="color: var(--text-gray); text-align: center;">–ê–∫—Ç–∏–≤–Ω–∏—Ö –æ–ø–æ–≤—ñ—â–µ–Ω—å –Ω–µ–º–∞—î</p>';
                return;
            }

            alertsList.innerHTML = activeAlerts.map(alert => `
                <div class="alert-item">
                    <div style="display: flex; justify-content: between; align-items: start; gap: 10px;">
                        <div style="flex: 1;">
                            <div style="font-weight: 500; margin-bottom: 5px;">${alert.text}</div>
                            <div style="font-size: 11px; color: var(--text-gray);">
                                ${new Date(alert.createdAt).toLocaleString()} ‚Ä¢ ${alert.createdBy}
                            </div>
                        </div>
                        <div style="display: flex; gap: 5px; flex-shrink: 0;">
                            <button class="alert-btn" onclick="toggleAlert('${alert.id}')" 
                                    style="background: ${alert.active ? 'var(--success)' : 'var(--error)'};">
                                ${alert.active ? '‚úì' : '‚úó'}
                            </button>
                            <button class="alert-btn" onclick="archiveAlert('${alert.id}')" 
                                    style="background: var(--warning);">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function toggleAlert(alertId) {
            const alert = systemAlerts.find(a => a.id === alertId);
            if (alert) {
                alert.active = !alert.active;
                database.ref('systemAlerts').set(systemAlerts)
                    .then(() => {
                        showNotification(`–û–ø–æ–≤—ñ—â–µ–Ω–Ω—è ${alert.active ? '–∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ' : '–¥–µ–∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ'}`, 'success');
                        updateAlertsDisplay();
                        showActiveAlert();
                    });
            }
        }

        function archiveAlert(alertId) {
            const alert = systemAlerts.find(a => a.id === alertId);
            if (alert) {
                alert.archived = true;
                alert.active = false;
                database.ref('systemAlerts').set(systemAlerts)
                    .then(() => {
                        showNotification('–û–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∞—Ä—Ö—ñ–≤–æ–≤–∞–Ω–æ', 'success');
                        updateAlertsDisplay();
                        hideAlert();
                    });
            }
        }

        // ===== üìù –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –ù–ê–ó–í–ê–ù–ò–ô –ü–û–î–†–ê–ó–î–ï–õ–û–í =====
        function editCardTitle(cardId, event) {
            if (!currentUser) return;
            event.stopPropagation();
            
            const currentTitle = getPageTitle(cardId);
            const newTitle = prompt('–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤—É –Ω–∞–∑–≤—É —Ä–æ–∑–¥—ñ–ª—É:', currentTitle);
            
            if (newTitle && newTitle !== currentTitle) {
                updateCardTitle(cardId, newTitle);
            }
        }

        function updateCardTitle(cardId, newTitle) {
            const content = contentStorage[cardId];
            if (!content) return;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ
            const newContent = content.replace(/<h1[^>]*>.*?<\/h1>/i, `<h1>${newTitle}</h1>`);
            contentStorage[cardId] = newContent;
            
            saveContentToFirebase();
            addSystemLog('title_edit', `–ó–º—ñ–Ω–µ–Ω–æ –Ω–∞–∑–≤—É —Ä–æ–∑–¥—ñ–ª—É: "${getPageTitle(cardId)}" ‚Üí "${newTitle}"`);
            updateAllPages();
            updateEnhancedMenu();
            
            showNotification(`–ù–∞–∑–≤—É —Ä–æ–∑–¥—ñ–ª—É –æ–Ω–æ–≤–ª–µ–Ω–æ!`, 'success');
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function updatePage(pageId, prefix) {
            const grid = document.getElementById(`${pageId}-grid`);
            if (!grid) return;
            
            const pageCards = Object.keys(contentStorage)
                .filter(key => key.startsWith(prefix))
                .sort();
            
            if (pageCards.length === 0) {
                grid.innerHTML = '<p style="color: var(--text-gray); text-align: center; grid-column: 1/-1;">–†–æ–∑–¥—ñ–ª–∏ —â–µ –Ω–µ –¥–æ–¥–∞–Ω—ñ</p>';
                return;
            }
            
            grid.innerHTML = pageCards.map(cardId => {
                const title = getPageTitle(cardId);
                const canEdit = currentUser && currentUser.isAdmin;
                
                return `
                    <div class="chapter-card" onclick="showContentPage('${cardId}', '${title}')">
                        <h4>${title}</h4>
                        ${canEdit ? `
                            <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 5px;">
                                <button class="delete-card-btn" onclick="deleteCard('${cardId}', event)" title="–í–∏–¥–∞–ª–∏—Ç–∏ —Ä–æ–∑–¥—ñ–ª">
                                    üóëÔ∏è
                                </button>
                                <button class="delete-card-btn" onclick="editCardTitle('${cardId}', event)" 
                                        style="background: var(--warning);" title="–ó–º—ñ–Ω–∏—Ç–∏ –Ω–∞–∑–≤—É">
                                    ‚úèÔ∏è
                                </button>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        function getActionText(action, details) {
            const actions = {
                'card_created': '—Å—Ç–≤–æ—Ä–∏–≤ —Ä–æ–∑–¥—ñ–ª',
                'card_deleted': '–≤–∏–¥–∞–ª–∏–≤ —Ä–æ–∑–¥—ñ–ª', 
                'content_edit': '–≤—ñ–¥—Ä–µ–¥–∞–≥–æ–≤–∞–≤ —Ä–æ–∑–¥—ñ–ª',
                'title_edit': '–∑–º—ñ–Ω–∏–≤ –Ω–∞–∑–≤—É —Ä–æ–∑–¥—ñ–ª—É',
                'user_added': '–¥–æ–¥–∞–≤ –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞',
                'alert_created': '—Å—Ç–≤–æ—Ä–∏–≤ –æ–ø–æ–≤—ñ—â–µ–Ω–Ω—è'
            };
            
            return `${actions[action] || action} - ${details}`;
        }

        // ===== –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ù–ê–í–ò–ì–ê–¶–ò–Ø =====
        function showPage(pageId) {
            console.log('Showing page:', pageId);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü
            const contentPages = document.getElementById('content-pages');
            if (contentPages) {
                contentPages.innerHTML = '';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –≤ –º–µ–Ω—é
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === pageId) {
                    link.classList.add('active');
                }
            });
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–∞–π–¥–±–∞—Ä –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
            if (window.innerWidth <= 768) {
                const sidebar = document.querySelector('.sidebar');
                if (sidebar) {
                    sidebar.classList.remove('active');
                }
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –º–µ–Ω—é
            const menuToggle = document.querySelector('.menu-toggle');
            if (menuToggle) {
                menuToggle.style.display = 'block';
            }
        }

        // ===== –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded - setting up event listeners');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.addEventListener('click', function() {
                    const pageId = this.getAttribute('data-page');
                    console.log('Card clicked:', pageId);
                    if (pageId) {
                        showPage(pageId);
                    }
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å—Å—ã–ª–æ–∫ –≤ –º–µ–Ω—é
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    console.log('Nav link clicked:', pageId);
                    if (pageId) {
                        showPage(pageId);
                    }
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é
            const menuToggle = document.querySelector('.menu-toggle');
            if (menuToggle) {
                menuToggle.addEventListener('click', function() {
                    const sidebar = document.querySelector('.sidebar');
                    if (sidebar) {
                        sidebar.classList.toggle('active');
                        this.style.display = 'none';
                    }
                });
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–∞–π–¥–±–∞—Ä–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', function(e) {
                const sidebar = document.querySelector('.sidebar');
                const menuToggle = document.querySelector('.menu-toggle');
                
                if (sidebar && menuToggle && 
                    !sidebar.contains(e.target) && 
                    !menuToggle.contains(e.target)) {
                    sidebar.classList.remove('active');
                    menuToggle.style.display = 'block';
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            const authModal = document.querySelector('.auth-modal');
            const cardModal = document.querySelector('.card-modal');
            
            if (authModal) {
                authModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                    }
                });
            }
            
            if (cardModal) {
                cardModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeCardModal();
                    }
                });
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
            initializeEnhancedSystem();
        });

        // ===== üî• –°–ò–°–¢–ï–ú–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô =====
        function showNotification(message, type = 'info', duration = 3000) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, duration);
            
            return notification;
        }

        // ===== üéØ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –î–ï–ô–°–¢–í–ò–ô =====
        function confirmAction(message) {
            return confirm(`‚ö†Ô∏è ${message}\n\n–¶—é –¥—ñ—é –Ω–µ–º–æ–∂–ª–∏–≤–æ —Å–∫–∞—Å—É–≤–∞—Ç–∏!`);
        }

        // ===== üì∏ –°–ò–°–¢–ï–ú–ê –ó–ê–ì–†–£–ó–ö–ò –§–û–¢–û =====
        function uploadImage() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showNotification('–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä: 5MB', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageData = e.target.result;
                    insertImageToEditor(imageData);
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }

        function insertImageToEditor(imageData) {
            const editor = document.getElementById('new-card-content');
            if (editor) {
                const img = document.createElement('img');
                img.src = imageData;
                img.style.maxWidth = '100%';
                img.style.height = 'auto';
                img.style.borderRadius = '8px';
                img.style.margin = '10px 0';
                
                editor.appendChild(img);
                editor.focus();
                showNotification('–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ–¥–∞–Ω–æ —É —Ä–µ–¥–∞–∫—Ç–æ—Ä', 'success');
            }
        }

        // ===== üìù WYSIWYG –†–ï–î–ê–ö–¢–û–† =====
        function formatText(command, value = null) {
            document.execCommand(command, false, value);
            document.getElementById('new-card-content').focus();
        }

        // ===== ENHANCED MENU SYSTEM =====
        function updateEnhancedMenu() {
            const sections = {
                'exams': 'exam',
                'lectures': 'lecture', 
                'training': 'training',
                'tasks': 'task'
            };
            
            Object.keys(sections).forEach(section => {
                const dropdown = document.querySelector(`[data-page="${section}"] + .dropdown-content`);
                if (dropdown) {
                    dropdown.innerHTML = '';
                    
                    const sectionCards = Object.keys(contentStorage)
                        .filter(key => key.startsWith(sections[section]))
                        .sort();
                    
                    if (sectionCards.length > 0) {
                        sectionCards.forEach(cardId => {
                            const link = document.createElement('a');
                            link.href = '#';
                            link.textContent = getPageTitle(cardId);
                            link.onclick = () => showContentPage(cardId, getPageTitle(cardId));
                            dropdown.appendChild(link);
                        });
                    } else {
                        const emptyMsg = document.createElement('div');
                        emptyMsg.textContent = '–†–æ–∑–¥—ñ–ª–∏ —â–µ –Ω–µ –¥–æ–¥–∞–Ω—ñ';
                        emptyMsg.style.color = 'var(--text-gray)';
                        emptyMsg.style.padding = '8px 12px';
                        emptyMsg.style.fontSize = '12px';
                        dropdown.appendChild(emptyMsg);
                    }
                }
            });
        }

        // ===== –°–û–ó–î–ê–ù–ò–ï –ù–û–í–û–ì–û –†–ê–ó–î–ï–õ–ê =====
        function createNewCard() {
            if (!currentUser) return;
            
            const sectionType = document.getElementById('section-type').value;
            const cardTitle = document.getElementById('new-card-title').value.trim();
            const cardContent = document.getElementById('new-card-content').innerHTML;
            
            if (!cardTitle) {
                showNotification('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ä–æ–∑–¥—ñ–ª—É', 'error');
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∑–≤–∞–Ω–∏—è
            const cardId = `${sectionType}-${cardTitle.toLowerCase().replace(/[^a-z0-9–∞-—è—ñ—ó—î“ë\s]/g, '').replace(/\s+/g, '-')}`;
            
            if (contentStorage[cardId]) {
                showNotification('–†–æ–∑–¥—ñ–ª –∑ —Ç–∞–∫–æ—é –Ω–∞–∑–≤–æ—é –≤–∂–µ —ñ—Å–Ω—É—î!', 'error');
                return;
            }
            
            contentStorage[cardId] = cardContent;
            saveContentToFirebase();
            addSystemLog('card_created', `–°—Ç–≤–æ—Ä–µ–Ω–æ —Ä–æ–∑–¥—ñ–ª: ${cardTitle}`);
            updateAllPages();
            updateEnhancedMenu();
            closeCardModal();
            
            showNotification(`–†–æ–∑–¥—ñ–ª "${cardTitle}" —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ!`, 'success');
        }

        function showCardModal() {
            if (!currentUser) {
                showNotification('–î–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–æ–∑–¥—ñ–ª—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ —É–≤—ñ–π—Ç–∏ —è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä', 'error');
                return;
            }
            
            const modal = document.querySelector('.card-modal');
            
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            document.getElementById('new-card-title').value = '';
            document.getElementById('new-card-content').innerHTML = '–û–ø–∏—à—ñ—Ç—å –∑–º—ñ—Å—Ç —Ä–æ–∑–¥—ñ–ª—É...';
            
            modal.classList.add('active');
        }

        function showExamModal() { showCardModal('exam'); }
        function showLectureModal() { showCardModal('lecture'); }
        function showTrainingModal() { showCardModal('training'); }
        function showTaskModal() { showCardModal('task'); }

        function closeCardModal() {
            document.querySelector('.card-modal').classList.remove('active');
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –ö–û–ù–¢–ï–ù–¢–ê =====
        function showContentPage(contentId, title) {
            const pages = document.querySelectorAll('.page');
            const contentPages = document.getElementById('content-pages');
            
            pages.forEach(page => page.classList.remove('active'));
            contentPages.innerHTML = '';
            
            const parentPage = getParentPage(contentId);
            const canEdit = currentUser && currentUser.isAdmin;
            
            contentPages.innerHTML = `
                <div class="page active">
                    <button class="back-button" onclick="showPage('${parentPage}')">‚Üê –ù–∞–∑–∞–¥</button>
                    <div class="content-page">
                        <div class="content-header">
                            <h2>${title}</h2>
                        </div>
                        <div class="content-body" id="content-${contentId}">
                            ${contentStorage[contentId] || '–ö–æ–Ω—Ç–µ–Ω—Ç —â–µ –Ω–µ –¥–æ–¥–∞–Ω–æ'}
                        </div>
                        ${canEdit ? `
                        <div class="edit-section">
                            <h4>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç:</h4>
                            <div class="editor-toolbar">
                                <button class="editor-btn" onclick="formatEditText('${contentId}', 'bold')" title="–ñ–∏—Ä–Ω–∏–π"><b>B</b></button>
                                <button class="editor-btn" onclick="formatEditText('${contentId}', 'italic')" title="–ö—É—Ä—Å–∏–≤"><i>I</i></button>
                                <button class="editor-btn" onclick="formatEditText('${contentId}', 'insertUnorderedList')" title="–ú–∞—Ä–∫–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫">‚â°</button>
                                <button class="editor-btn" onclick="uploadEditImage('${contentId}')" title="–î–æ–¥–∞—Ç–∏ —Ñ–æ—Ç–æ">üì∑</button>
                            </div>
                            <div class="editor-content" id="edit-${contentId}" contenteditable="true">${contentStorage[contentId] || ''}</div>
                            <button class="edit-button" onclick="saveContentItem('${contentId}')">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
            
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === parentPage) {
                    link.classList.add('active');
                }
            });
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function formatEditText(contentId, command, value = null) {
            const editor = document.getElementById(`edit-${contentId}`);
            if (editor) {
                document.execCommand(command, false, value);
                editor.focus();
            }
        }

        function uploadEditImage(contentId) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                if (file.size > 5 * 1024 * 1024) {
                    showNotification('–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä: 5MB', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageData = e.target.result;
                    const editor = document.getElementById(`edit-${contentId}`);
                    if (editor) {
                        const img = document.createElement('img');
                        img.src = imageData;
                        img.style.maxWidth = '100%';
                        img.style.height = 'auto';
                        img.style.borderRadius = '8px';
                        img.style.margin = '10px 0';
                        
                        editor.appendChild(img);
                        editor.focus();
                        showNotification('–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ–¥–∞–Ω–æ', 'success');
                    }
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }

        function saveContentItem(contentId) {
            if (!currentUser || !currentUser.isAdmin) return;
            
            const editor = document.getElementById(`edit-${contentId}`);
            if (editor) {
                contentStorage[contentId] = editor.innerHTML;
                const contentElement = document.getElementById(`content-${contentId}`);
                if (contentElement) {
                    contentElement.innerHTML = contentStorage[contentId];
                }
                
                addSystemLog('content_edit', `–í—ñ–¥—Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ —Ä–æ–∑–¥—ñ–ª: ${getPageTitle(contentId)}`);
                saveContentToFirebase();
                
                showNotification('–ó–º—ñ–Ω–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!', 'success');
            }
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –£–î–ê–õ–ï–ù–ò–Ø =====
        function deleteCard(cardId, event) {
            if (!currentUser) return;
            event.stopPropagation();
            
            const cardTitle = getPageTitle(cardId);
            
            if (!confirmAction(`–í–∏–¥–∞–ª–∏—Ç–∏ —Ä–æ–∑–¥—ñ–ª "${cardTitle}"?`)) {
                return;
            }
            
            delete contentStorage[cardId];
            saveContentToFirebase();
            addSystemLog('card_deleted', `–í–∏–¥–∞–ª–µ–Ω–æ —Ä–æ–∑–¥—ñ–ª: ${cardTitle}`);
            updateAllPages();
            updateEnhancedMenu();
            showNotification(`–†–æ–∑–¥—ñ–ª "${cardTitle}" —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ!`, 'success');
        }

        // ===== –°–ò–°–¢–ï–ú–ê –õ–û–ì–û–í =====
        function addSystemLog(action, details) {
            if (!currentUser) return;
            
            const log = {
                timestamp: new Date().toISOString(),
                user: currentUser.username,
                action: action,
                details: details
            };
            
            systemLogs.unshift(log);
            if (systemLogs.length > 50) systemLogs = systemLogs.slice(0, 50);
            
            database.ref('systemLogs').set(systemLogs)
                .catch(error => console.error('Error saving logs:', error));
            
            updateLogsDisplay();
        }

        function loadLogsFromFirebase() {
            database.ref('systemLogs').on('value', (snapshot) => {
                const logs = snapshot.val();
                if (logs) {
                    systemLogs = logs;
                    updateLogsDisplay();
                }
            });
        }

        function updateLogsDisplay() {
            const logsList = document.getElementById('logs-list');
            if (!logsList) return;
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –ª–æ–≥–∏ - —É–±–∏—Ä–∞–µ–º –≤—Ö–æ–¥—ã/–≤—ã—Ö–æ–¥—ã
            const filteredLogs = systemLogs.filter(log => 
                !log.details.includes('–≤–≤—ñ–π—à–æ–≤ –≤ —Å–∏—Å—Ç–µ–º—É') && 
                !log.details.includes('–≤–∏–π—à–æ–≤ –∑ —Å–∏—Å—Ç–µ–º–∏')
            );
            
            logsList.innerHTML = filteredLogs.map(log => `
                <div class="log-item">
                    <span class="log-time">${new Date(log.timestamp).toLocaleString()}</span>
                    <span class="log-user">${log.user}:</span>
                    ${getActionText(log.action, log.details)}
                </div>
            `).join('');
        }

        // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ö–û–ù–¢–ï–ù–¢–û–ú =====
        function loadContentFromFirebase() {
            database.ref('content').on('value', (snapshot) => {
                const content = snapshot.val();
                if (content) {
                    contentStorage = content;
                } else {
                    initializeDefaultContent();
                }
                updateAllPages();
                updateEnhancedMenu();
            });
        }

        function updateAllPages() {
            updatePage('exams', 'exam');
            updatePage('lectures', 'lecture');
            updatePage('training', 'training');
            updatePage('tasks', 'task');
        }

        function initializeDefaultContent() {
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
            const defaultContent = {
                'exam-basic': '<h1>–ë–∞–∑–æ–≤–∏–π —ñ—Å–ø–∏—Ç</h1><p>–û—Å–Ω–æ–≤–∏ –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —Å–ª—É–∂–±–∏ —Ç–∞ —É—Å—Ç–∞–≤–Ω—ñ –≤–∑–∞—î–º–∏–Ω–∏</p>',
                'exam-tactical': '<h1>–¢–∞–∫—Ç–∏—á–Ω–∏–π —ñ—Å–ø–∏—Ç</h1><p>–¢–∞–∫—Ç–∏–∫–∞ –≤–µ–¥–µ–Ω–Ω—è –±–æ—é —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–æ–º</p>',
                'exam-firearms': '<h1>–Ü—Å–ø–∏—Ç –∑—ñ —Å—Ç—Ä—ñ–ª–µ–±–∫–æ—ó –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏</h1><p>–¢–µ–æ—Ä—ñ—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ —Å—Ç—Ä—ñ–ª—å–±–∏ –∑ —Ä—ñ–∑–Ω–∏—Ö –≤–∏–¥—ñ–≤ –æ–∑–±—Ä–æ—î–Ω–Ω—è</p>',
                
                'lecture-tactics': '<h1>–¢–∞–∫—Ç–∏–∫–∞ –≤–µ–¥–µ–Ω–Ω—è –±–æ—é</h1><p>–û—Å–Ω–æ–≤–∏ —Ç–∞–∫—Ç–∏–∫–∏, –º–∞–Ω–µ–≤—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó –¥—ñ–π</p>',
                'lecture-communication': '<h1>–ó–∞—Å–æ–±–∏ –∑–≤\'—è–∑–∫—É —Ç–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó</h1><p>–†–æ–±–æ—Ç–∞ –∑ —Ä–∞—Ü—ñ—è–º–∏, –∫–æ–¥–æ–≤—ñ —Ñ—Ä–∞–∑–∏ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ –∑–≤\'—è–∑–∫—É</p>',
                'lecture-first-aid': '<h1>–ü–µ—Ä—à–∞ –º–µ–¥–∏—á–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞</h1><p>–ù–∞–¥–∞–Ω–Ω—è –ø–µ—Ä—à–æ—ó –¥–æ–ø–æ–º–æ–≥–∏ –Ω–∞ –ø–æ–ª—ñ –±–æ—é</p>',
                
                'training-shooting': '<h1>–°—Ç—Ä—ñ–ª—å–±–∞</h1><p>–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –∑—ñ —Å—Ç—Ä—ñ–ª—å–±–∏ –Ω–∞ –ø–æ–ª—ñ–≥–æ–Ω—ñ</p>',
                'training-physical': '<h1>–§—ñ–∑–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞</h1><p>–ó–∞–≥–∞–ª—å–Ω–∞ —Ñ—ñ–∑–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–∞ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –≤–ø—Ä–∞–≤–∏</p>',
                'training-tactical': '<h1>–¢–∞–∫—Ç–∏—á–Ω—ñ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è</h1><p>–í—ñ–¥–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è —Ç–∞–∫—Ç–∏—á–Ω–∏—Ö –ø—Ä–∏–π–æ–º—ñ–≤ –Ω–∞ –º—ñ—Å—Ü–µ–≤–æ—Å—Ç—ñ</p>',
                
                'task-patrol': '<h1>–ü–∞—Ç—Ä—É–ª—é–≤–∞–Ω–Ω—è</h1><p>–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è —Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –ø–∞—Ç—Ä—É–ª—é–≤–∞–Ω–Ω—è</p>',
                'task-checkpoint': '<h1>–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ-–ø—Ä–æ–ø—É—Å–∫–Ω–∏–π –ø—É–Ω–∫—Ç</h1><p>–†–æ–±–æ—Ç–∞ –Ω–∞ –ö–ü–ü —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤</p>',
                'task-ambush': '<h1>–í–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–∞—Å—ñ–¥–∫–∏</h1><p>–ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –∑–∞—Å—ñ–¥–∫–∏</p>'
            };
            
            contentStorage = defaultContent;
            saveContentToFirebase();
        }

        function saveContentToFirebase() {
            if (Object.keys(contentStorage).length > 0) {
                database.ref('content').set(contentStorage)
                    .catch(error => {
                        console.error('Error saving content:', error);
                        showNotification('–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö', 'error');
                    });
            }
        }

        function getParentPage(contentId) {
            if (contentId.startsWith('exam-')) return 'exams';
            if (contentId.startsWith('lecture-')) return 'lectures';
            if (contentId.startsWith('training-')) return 'training';
            if (contentId.startsWith('task-')) return 'tasks';
            return 'home';
        }

        function getPageTitle(contentId) {
            const content = contentStorage[contentId];
            if (!content) return '–ë–µ–∑ –Ω–∞–∑–≤–∏';
            
            const match = content.match(/<h1[^>]*>(.*?)<\/h1>/i);
            return match ? match[1].replace(/<[^>]*>/g, '') : '–ë–µ–∑ –Ω–∞–∑–≤–∏';
        }

        // ===== –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø =====
        function showLoginModal() {
            document.querySelector('.auth-modal').classList.add('active');
        }

        function login() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const message = document.getElementById('login-message');
            
            if (!username || !password) {
                showMessage(message, '–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è', 'error');
                return;
            }
            
            const email = `${username}@military-academy.com`;
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    showMessage(message, '–£—Å–ø—ñ—à–Ω–∏–π –≤—Ö—ñ–¥!', 'success');
                    setTimeout(() => {
                        document.querySelector('.auth-modal').classList.remove('active');
                    }, 1000);
                })
                .catch((error) => {
                    showMessage(message, '–ù–µ–≤—ñ—Ä–Ω–∏–π –ª–æ–≥—ñ–Ω –∞–±–æ –ø–∞—Ä–æ–ª—å', 'error');
                    console.error('Login error:', error);
                });
        }

        function logout() {
            if (confirmAction('–í–∏ –¥—ñ–π—Å–Ω–æ –±–∞–∂–∞—î—Ç–µ –≤–∏–π—Ç–∏?')) {
                auth.signOut().then(() => {
                    showNotification('–í–∏ —É—Å–ø—ñ—à–Ω–æ –≤–∏–π—à–ª–∏ –∑ —Å–∏—Å—Ç–µ–º–∏', 'info');
                });
            }
        }

        function showMessage(element, text, type) {
            element.textContent = text;
            element.className = `auth-message ${type}`;
            element.style.display = 'block';
        }

        function updateUserPanel() {
            const loginBtn = document.getElementById('login-btn');
            const userInfo = document.getElementById('user-info');
            const adminBtn = document.getElementById('admin-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const adminAddSection = document.getElementById('admin-add-section');
            
            if (currentUser) {
                loginBtn.style.display = 'none';
                userInfo.style.display = 'block';
                adminBtn.style.display = 'block';
                logoutBtn.style.display = 'block';
                adminAddSection.style.display = 'block';
                userInfo.textContent = currentUser.username;
            } else {
                loginBtn.style.display = 'block';
                userInfo.style.display = 'none';
                adminBtn.style.display = 'none';
                logoutBtn.style.display = 'none';
                adminAddSection.style.display = 'none';
            }
        }

        // ===== –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ =====
        function showAdminPanel() {
            if (!currentUser) return;
            
            document.querySelector('.admin-overlay').classList.add('active');
            document.querySelector('.admin-panel').classList.add('active');
            updateLogsDisplay();
            updateAlertsDisplay();
        }

        function closeAdminPanel() {
            document.querySelector('.admin-overlay').classList.remove('active');
            document.querySelector('.admin-panel').classList.remove('active');
        }

        function addUser() {
            if (!currentUser) return;
            
            const username = document.getElementById('new-username').value;
            const password = document.getElementById('new-password').value;
            
            if (!username || !password) {
                showNotification('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è', 'error');
                return;
            }
            
            const email = `${username}@military-academy.com`;
            
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    showNotification('–ù–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–æ!', 'success');
                    document.getElementById('new-username').value = '';
                    document.getElementById('new-password').value = '';
                    addSystemLog('user_added', `–î–æ–¥–∞–Ω–æ –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞: ${username}`);
                })
                .catch((error) => {
                    showNotification('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞', 'error');
                    console.error('User creation error:', error);
                });
        }

        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –£–õ–£–ß–®–ï–ù–ù–û–ô –°–ò–°–¢–ï–ú–´ =====
        function initializeEnhancedSystem() {
            initializeData();
            updateFavoritesDisplay();
            
            console.log(`
            ===== MILITARY ACADEMY =====
            ‚úÖ –ù–∞–≤—ñ–≥–∞—Ü—ñ—è: ACTIVE
            ‚úÖ –§–æ—Ç–æ: ACTIVE  
            ‚úÖ –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å: ACTIVE
            ‚úÖ –û–ø–æ–≤—ñ—â–µ–Ω–Ω—è: ACTIVE
            üöÄ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ —Ä–æ–±–æ—Ç–∏!
            `);
        }

        function initializeData() {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    currentUser = {
                        username: user.email.split('@')[0],
                        isAdmin: true,
                        uid: user.uid
                    };
                    updateUserPanel();
                    loadContentFromFirebase();
                    loadLogsFromFirebase();
                    loadAlertsFromFirebase();
                } else {
                    currentUser = null;
                    updateUserPanel();
                    loadContentFromFirebase();
                    loadAlertsFromFirebase();
                }
            });
        }

        function updateFavoritesDisplay() {
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
        }
    </script>
</body>
</html>
